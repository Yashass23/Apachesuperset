{"version":3,"file":"1012e7178c8db1839d0e.chunk.js","mappings":"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","sources":["webpack://superset/./src/types/ChartSource.ts","webpack://superset/./src/components/Chart/types.ts","webpack://superset/./src/components/Chart/DrillBy/DrillByChart.tsx","webpack://superset/./src/components/Chart/DrillBy/useDrillByBreadcrumbs.tsx","webpack://superset/./src/components/Chart/DrillBy/useResultsTableView.tsx","webpack://superset/./src/components/Chart/DrillBy/DrillByModal.tsx","webpack://superset/./src/components/Chart/DrillBy/useDisplayModeToggle.tsx","webpack://superset/./src/components/Chart/ChartContextMenu/useContextMenu.tsx","webpack://superset/./src/components/Chart/DrillBy/DrillByMenuItems.tsx","webpack://superset/./src/hooks/apiResources/datasets.ts","webpack://superset/./src/components/Chart/ChartContextMenu/ChartContextMenu.tsx","webpack://superset/./src/components/Chart/ChartRenderer.jsx","webpack://superset/./src/components/Chart/ChartErrorMessage.tsx","webpack://superset/./src/components/Chart/Chart.jsx","webpack://superset/./src/components/Chart/ChartContainer.jsx","webpack://superset/./src/explore/components/EmbedCodeContent.jsx","webpack://superset/./src/explore/components/useExploreAdditionalActionsMenu/DashboardsSubMenu.tsx","webpack://superset/./src/explore/components/useExploreAdditionalActionsMenu/index.jsx","webpack://superset/./src/components/Chart/DisabledMenuItemTooltip.tsx","webpack://superset/./src/components/Table/cell-renderers/BooleanCell/index.tsx","webpack://superset/./src/components/Table/cell-renderers/NullCell/index.tsx","webpack://superset/./src/components/Table/cell-renderers/TimeCell/index.tsx","webpack://superset/./src/components/Table/header-renderers/HeaderWithRadioGroup.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailTableControls.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailPane.tsx","webpack://superset/./src/components/Chart/DrillDetail/utils.ts","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailModal.tsx","webpack://superset/./src/components/Chart/DrillDetail/DrillDetailMenuItems.tsx","webpack://superset/./src/components/Chart/MenuItemWithTruncation.tsx","webpack://superset/./src/components/Chart/utils.ts","webpack://superset/./src/components/Dropdown/index.tsx","webpack://superset/./src/dashboard/util/charts/getEffectiveExtraFilters.ts","webpack://superset/./src/dashboard/util/charts/getFormDataWithExtraFilters.ts","webpack://superset/./src/explore/components/DataTablesPane/components/DataTableControls.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/SingleQueryResultPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/types.ts","webpack://superset/./src/explore/components/DataTablesPane/components/useResultsPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/ResultsPaneOnDashboard.tsx","webpack://superset/./src/explore/components/DataTablesPane/components/SamplesPane.tsx","webpack://superset/./src/explore/components/DataTablesPane/DataTablesPane.tsx","webpack://superset/./src/explore/components/controls/ViewQueryModal.tsx","webpack://superset/./src/features/datasets/metadataBar/useDatasetMetadataBar.tsx","webpack://superset/./src/features/reports/types.ts","webpack://superset/./src/features/reports/ReportModal/index.tsx","webpack://superset/./src/features/reports/ReportModal/HeaderReportDropdown/index.tsx","webpack://superset/./src/hooks/useTabId.ts","webpack://superset/./src/utils/cachedSupersetGet.ts","webpack://superset/./src/utils/downloadAsImage.ts","webpack://superset/./src/utils/getChartRequiredFieldsMissingMessage.ts","webpack://superset/./src/utils/simpleFilterToAdhoc.ts"],"sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport enum ChartSource {\n  Explore = 'explore',\n  Dashboard = 'dashboard',\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Column, Metric } from '@superset-ui/core';\n\nexport enum DrillByType {\n  Chart,\n  Table,\n}\n\nexport type Dataset = {\n  changed_by?: {\n    first_name: string;\n    last_name: string;\n  };\n  created_by?: {\n    first_name: string;\n    last_name: string;\n  };\n  changed_on_humanized: string;\n  created_on_humanized: string;\n  description: string;\n  table_name: string;\n  owners: {\n    first_name: string;\n    last_name: string;\n  }[];\n  columns?: Column[];\n  metrics?: Metric[];\n  verbose_map?: Record<string, string>;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport {\n  BaseFormData,\n  QueryData,\n  SuperChart,\n  css,\n  ContextMenuFilters,\n} from '@superset-ui/core';\nimport { Dataset } from '../types';\n\ninterface DrillByChartProps {\n  formData: BaseFormData & { [key: string]: any };\n  result: QueryData[];\n  dataset: Dataset;\n  onContextMenu: (\n    offsetX: number,\n    offsetY: number,\n    filters: ContextMenuFilters,\n  ) => void;\n  inContextMenu: boolean;\n}\n\nexport default function DrillByChart({\n  formData,\n  result,\n  dataset,\n  onContextMenu,\n  inContextMenu,\n}: DrillByChartProps) {\n  const hooks = useMemo(() => ({ onContextMenu }), [onContextMenu]);\n\n  return (\n    <div\n      css={css`\n        width: 100%;\n        height: 100%;\n        min-height: 0;\n      `}\n      data-test=\"drill-by-chart\"\n    >\n      <SuperChart\n        disableErrorBoundary\n        chartType={formData.viz_type}\n        enableNoResults\n        datasource={dataset}\n        formData={formData}\n        queriesData={result}\n        hooks={hooks}\n        inContextMenu={inContextMenu}\n        height=\"100%\"\n        width=\"100%\"\n      />\n    </div>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useMemo } from 'react';\nimport {\n  BinaryQueryObjectFilterClause,\n  Column,\n  css,\n  ensureIsArray,\n  styled,\n  SupersetTheme,\n} from '@superset-ui/core';\nimport { AntdBreadcrumb } from 'src/components/index';\nimport { noOp } from 'src/utils/common';\n\nexport interface DrillByBreadcrumb {\n  groupby: Column | Column[];\n  filters?: BinaryQueryObjectFilterClause[];\n}\n\nconst BreadcrumbItem = styled(AntdBreadcrumb.Item)<{ isClickable: boolean }>`\n  ${({ theme, isClickable }) => css`\n    cursor: ${isClickable ? 'pointer' : 'auto'};\n    color: ${theme.colors.grayscale.light1};\n    transition: color ease-in ${theme.transitionTiming}s;\n    .ant-breadcrumb > span:last-child > & {\n      color: ${theme.colors.grayscale.dark1};\n    }\n    &:hover {\n      color: ${isClickable ? theme.colors.grayscale.dark1 : 'inherit'};\n    }\n  `}\n`;\n\nexport const useDrillByBreadcrumbs = (\n  breadcrumbsData: DrillByBreadcrumb[],\n  onBreadcrumbClick: (\n    breadcrumb: DrillByBreadcrumb,\n    index: number,\n  ) => void = noOp,\n) =>\n  useMemo(() => {\n    // the last breadcrumb is not clickable\n    const isClickable = (index: number) => index < breadcrumbsData.length - 1;\n    const getBreadcrumbText = (breadcrumb: DrillByBreadcrumb) =>\n      `${ensureIsArray(breadcrumb.groupby)\n        .map(column => column.verbose_name || column.column_name)\n        .join(', ')} ${\n        breadcrumb.filters\n          ? `(${breadcrumb.filters\n              .map(filter => filter.formattedVal || filter.val)\n              .join(', ')})`\n          : ''\n      }`;\n    return (\n      <AntdBreadcrumb\n        css={(theme: SupersetTheme) => css`\n          margin: ${theme.gridUnit * 2}px 0 ${theme.gridUnit * 4}px;\n        `}\n      >\n        {breadcrumbsData.map((breadcrumb, index) => (\n          <BreadcrumbItem\n            key={index}\n            isClickable={isClickable(index)}\n            onClick={\n              isClickable(index)\n                ? () => onBreadcrumbClick(breadcrumb, index)\n                : noOp\n            }\n            data-test=\"drill-by-breadcrumb-item\"\n          >\n            {getBreadcrumbText(breadcrumb)}\n          </BreadcrumbItem>\n        ))}\n      </AntdBreadcrumb>\n    );\n  }, [breadcrumbsData, onBreadcrumbClick]);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { css, styled, isDefined, QueryData, t } from '@superset-ui/core';\nimport { SingleQueryResultPane } from 'src/explore/components/DataTablesPane/components/SingleQueryResultPane';\nimport Tabs from 'src/components/Tabs';\n\nconst DATA_SIZE = 15;\n\nconst PaginationContainer = styled.div`\n  ${({ theme }) => css`\n    & .pagination-container {\n      bottom: ${-theme.gridUnit * 4}px;\n    }\n  `}\n`;\n\nexport const useResultsTableView = (\n  chartDataResult: QueryData[] | undefined,\n  datasourceId: string,\n) => {\n  if (!isDefined(chartDataResult)) {\n    return <div />;\n  }\n  if (chartDataResult.length === 1) {\n    return (\n      <PaginationContainer data-test=\"drill-by-results-table\">\n        <SingleQueryResultPane\n          colnames={chartDataResult[0].colnames}\n          coltypes={chartDataResult[0].coltypes}\n          data={chartDataResult[0].data}\n          dataSize={DATA_SIZE}\n          datasourceId={datasourceId}\n          isVisible\n        />\n      </PaginationContainer>\n    );\n  }\n  return (\n    <Tabs fullWidth={false} data-test=\"drill-by-results-tabs\">\n      {chartDataResult.map((res, index) => (\n        <Tabs.TabPane tab={t('Results %s', index + 1)} key={index}>\n          <PaginationContainer>\n            <SingleQueryResultPane\n              colnames={res.colnames}\n              coltypes={res.coltypes}\n              data={res.data}\n              dataSize={DATA_SIZE}\n              datasourceId={datasourceId}\n              isVisible\n            />\n          </PaginationContainer>\n        </Tabs.TabPane>\n      ))}\n    </Tabs>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport {\n  BaseFormData,\n  Column,\n  QueryData,\n  css,\n  ensureIsArray,\n  isDefined,\n  t,\n  useTheme,\n  ContextMenuFilters,\n} from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport Modal from 'src/components/Modal';\nimport Loading from 'src/components/Loading';\nimport Button from 'src/components/Button';\nimport { RootState } from 'src/dashboard/types';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { postFormData } from 'src/explore/exploreUtils/formData';\nimport { simpleFilterToAdhoc } from 'src/utils/simpleFilterToAdhoc';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Alert from 'src/components/Alert';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  LOG_ACTIONS_DRILL_BY_BREADCRUMB_CLICKED,\n  LOG_ACTIONS_DRILL_BY_EDIT_CHART,\n  LOG_ACTIONS_DRILL_BY_MODAL_OPENED,\n  LOG_ACTIONS_FURTHER_DRILL_BY,\n} from 'src/logger/LogUtils';\nimport { getQuerySettings } from 'src/explore/exploreUtils';\nimport { Dataset, DrillByType } from '../types';\nimport DrillByChart from './DrillByChart';\nimport { ContextMenuItem } from '../ChartContextMenu/ChartContextMenu';\nimport { useContextMenu } from '../ChartContextMenu/useContextMenu';\nimport { getChartDataRequest, handleChartDataResponse } from '../chartAction';\nimport { useDisplayModeToggle } from './useDisplayModeToggle';\nimport {\n  DrillByBreadcrumb,\n  useDrillByBreadcrumbs,\n} from './useDrillByBreadcrumbs';\nimport { useResultsTableView } from './useResultsTableView';\n\nconst DEFAULT_ADHOC_FILTER_FIELD_NAME = 'adhoc_filters';\ninterface ModalFooterProps {\n  closeModal?: () => void;\n  formData: BaseFormData;\n}\n\nconst ModalFooter = ({ formData, closeModal }: ModalFooterProps) => {\n  const dispatch = useDispatch();\n  const { addDangerToast } = useToasts();\n  const [url, setUrl] = useState('');\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const onEditChartClick = useCallback(() => {\n    dispatch(\n      logEvent(LOG_ACTIONS_DRILL_BY_EDIT_CHART, {\n        slice_id: formData.slice_id,\n      }),\n    );\n  }, [dispatch, formData.slice_id]);\n\n  const [datasource_id, datasource_type] = formData.datasource.split('__');\n  useEffect(() => {\n    postFormData(Number(datasource_id), datasource_type, formData, 0)\n      .then(key => {\n        setUrl(\n          `/explore/?form_data_key=${key}&dashboard_page_id=${dashboardPageId}`,\n        );\n      })\n      .catch(() => {\n        addDangerToast(t('Failed to generate chart edit URL'));\n      });\n  }, [\n    addDangerToast,\n    dashboardPageId,\n    datasource_id,\n    datasource_type,\n    formData,\n  ]);\n  return (\n    <>\n      <Button\n        buttonStyle=\"secondary\"\n        buttonSize=\"small\"\n        onClick={onEditChartClick}\n        disabled={!url}\n      >\n        <Link\n          css={css`\n            &:hover {\n              text-decoration: none;\n            }\n          `}\n          to={url}\n        >\n          {t('Edit chart')}\n        </Link>\n      </Button>\n\n      <Button\n        buttonStyle=\"primary\"\n        buttonSize=\"small\"\n        onClick={closeModal}\n        data-test=\"close-drill-by-modal\"\n      >\n        {t('Close')}\n      </Button>\n    </>\n  );\n};\n\nexport interface DrillByModalProps {\n  column?: Column;\n  dataset: Dataset;\n  drillByConfig: Required<ContextMenuFilters>['drillBy'];\n  formData: BaseFormData & { [key: string]: any };\n  onHideModal: () => void;\n}\n\ntype DrillByConfigs = (ContextMenuFilters['drillBy'] & { column?: Column })[];\n\nexport default function DrillByModal({\n  column,\n  dataset,\n  drillByConfig,\n  formData,\n  onHideModal,\n}: DrillByModalProps) {\n  const dispatch = useDispatch();\n  const theme = useTheme();\n  const { addDangerToast } = useToasts();\n  const [isChartDataLoading, setIsChartDataLoading] = useState(true);\n\n  const [drillByConfigs, setDrillByConfigs] = useState<DrillByConfigs>([\n    { ...drillByConfig, column },\n  ]);\n\n  useEffect(() => {\n    dispatch(\n      logEvent(LOG_ACTIONS_DRILL_BY_MODAL_OPENED, {\n        slice_id: formData.slice_id,\n      }),\n    );\n  }, [dispatch, formData.slice_id]);\n\n  const {\n    column: currentColumn,\n    groupbyFieldName = drillByConfig.groupbyFieldName,\n  } = drillByConfigs[drillByConfigs.length - 1] || {};\n\n  const initialGroupbyColumns = useMemo(\n    () =>\n      ensureIsArray(formData[groupbyFieldName])\n        .map(colName =>\n          dataset.columns?.find(col => col.column_name === colName),\n        )\n        .filter(isDefined),\n    [dataset.columns, formData, groupbyFieldName],\n  );\n\n  const { displayModeToggle, drillByDisplayMode } = useDisplayModeToggle();\n  const [chartDataResult, setChartDataResult] = useState<QueryData[]>();\n\n  const resultsTable = useResultsTableView(\n    chartDataResult,\n    formData.datasource,\n  );\n\n  const [currentFormData, setCurrentFormData] = useState(formData);\n  const [usedGroupbyColumns, setUsedGroupbyColumns] = useState<Column[]>(\n    [...initialGroupbyColumns, column].filter(isDefined),\n  );\n  const [breadcrumbsData, setBreadcrumbsData] = useState<DrillByBreadcrumb[]>([\n    { groupby: initialGroupbyColumns, filters: drillByConfig.filters },\n    { groupby: column || [] },\n  ]);\n\n  const getNewGroupby = useCallback(\n    (groupbyCol: Column, fieldName = groupbyFieldName) =>\n      Array.isArray(formData[fieldName])\n        ? [groupbyCol.column_name]\n        : groupbyCol.column_name,\n    [formData, groupbyFieldName],\n  );\n\n  const getFormDataChangesFromConfigs = useCallback(\n    (configs: DrillByConfigs) =>\n      configs.reduce(\n        (acc, config) => {\n          if (config?.groupbyFieldName && config.column) {\n            acc.formData[config.groupbyFieldName] = getNewGroupby(\n              config.column,\n              config.groupbyFieldName,\n            );\n            acc.overridenGroupbyFields.add(config.groupbyFieldName);\n          }\n          const adhocFilterFieldName =\n            config?.adhocFilterFieldName || DEFAULT_ADHOC_FILTER_FIELD_NAME;\n          acc.formData[adhocFilterFieldName] = [\n            ...ensureIsArray(acc[adhocFilterFieldName]),\n            ...ensureIsArray(config.filters).map(filter =>\n              simpleFilterToAdhoc(filter),\n            ),\n          ];\n          acc.overridenAdhocFilterFields.add(adhocFilterFieldName);\n\n          return acc;\n        },\n        {\n          formData: {},\n          overridenGroupbyFields: new Set<string>(),\n          overridenAdhocFilterFields: new Set<string>(),\n        },\n      ),\n    [getNewGroupby],\n  );\n\n  const getFiltersFromConfigsByFieldName = useCallback(\n    () =>\n      drillByConfigs.reduce((acc, config) => {\n        const adhocFilterFieldName =\n          config.adhocFilterFieldName || DEFAULT_ADHOC_FILTER_FIELD_NAME;\n        acc[adhocFilterFieldName] = [\n          ...(acc[adhocFilterFieldName] || []),\n          ...config.filters.map(filter => simpleFilterToAdhoc(filter)),\n        ];\n        return acc;\n      }, {}),\n    [drillByConfigs],\n  );\n\n  const onBreadcrumbClick = useCallback(\n    (breadcrumb: DrillByBreadcrumb, index: number) => {\n      dispatch(\n        logEvent(LOG_ACTIONS_DRILL_BY_BREADCRUMB_CLICKED, {\n          slice_id: formData.slice_id,\n        }),\n      );\n      setDrillByConfigs(prevConfigs => prevConfigs.slice(0, index));\n      setBreadcrumbsData(prevBreadcrumbs => {\n        const newBreadcrumbs = prevBreadcrumbs.slice(0, index + 1);\n        delete newBreadcrumbs[newBreadcrumbs.length - 1].filters;\n        return newBreadcrumbs;\n      });\n      setUsedGroupbyColumns(prevUsedGroupbyColumns =>\n        prevUsedGroupbyColumns.slice(0, index),\n      );\n      setCurrentFormData(() => {\n        if (index === 0) {\n          return formData;\n        }\n        const { formData: overrideFormData, overridenAdhocFilterFields } =\n          getFormDataChangesFromConfigs(drillByConfigs.slice(0, index));\n\n        const newFormData = {\n          ...formData,\n          ...overrideFormData,\n        };\n        overridenAdhocFilterFields.forEach(adhocFilterField => ({\n          ...newFormData,\n          [adhocFilterField]: [\n            ...formData[adhocFilterField],\n            ...overrideFormData[adhocFilterField],\n          ],\n        }));\n        return newFormData;\n      });\n    },\n    [dispatch, drillByConfigs, formData, getFormDataChangesFromConfigs],\n  );\n\n  const breadcrumbs = useDrillByBreadcrumbs(breadcrumbsData, onBreadcrumbClick);\n\n  const drilledFormData = useMemo(() => {\n    let updatedFormData = { ...currentFormData };\n    if (currentColumn && groupbyFieldName) {\n      updatedFormData[groupbyFieldName] = getNewGroupby(currentColumn);\n    }\n\n    const adhocFilters = getFiltersFromConfigsByFieldName();\n    Object.keys(adhocFilters).forEach(adhocFilterFieldName => {\n      updatedFormData = {\n        ...updatedFormData,\n        [adhocFilterFieldName]: [\n          ...ensureIsArray(formData[adhocFilterFieldName]),\n          ...adhocFilters[adhocFilterFieldName],\n        ],\n      };\n    });\n\n    updatedFormData.slice_id = 0;\n    delete updatedFormData.slice_name;\n    delete updatedFormData.dashboards;\n    return updatedFormData;\n  }, [\n    currentFormData,\n    currentColumn,\n    groupbyFieldName,\n    getFiltersFromConfigsByFieldName,\n    getNewGroupby,\n    formData,\n  ]);\n\n  useEffect(() => {\n    setUsedGroupbyColumns(usedCols =>\n      !currentColumn ||\n      usedCols.some(\n        usedCol => usedCol.column_name === currentColumn.column_name,\n      )\n        ? usedCols\n        : [...usedCols, currentColumn],\n    );\n  }, [currentColumn]);\n\n  const onSelection = useCallback(\n    (\n      newColumn: Column,\n      drillByConfig: Required<ContextMenuFilters>['drillBy'],\n    ) => {\n      dispatch(\n        logEvent(LOG_ACTIONS_FURTHER_DRILL_BY, {\n          drill_depth: drillByConfigs.length + 1,\n          slice_id: formData.slice_id,\n        }),\n      );\n      setCurrentFormData(drilledFormData);\n      setDrillByConfigs(prevConfigs => [\n        ...prevConfigs,\n        { ...drillByConfig, column: newColumn },\n      ]);\n      setBreadcrumbsData(prevBreadcrumbs => {\n        const newBreadcrumbs = [...prevBreadcrumbs, { groupby: newColumn }];\n        newBreadcrumbs[newBreadcrumbs.length - 2].filters =\n          drillByConfig.filters;\n        return newBreadcrumbs;\n      });\n    },\n    [dispatch, drillByConfigs.length, drilledFormData, formData.slice_id],\n  );\n\n  const additionalConfig = useMemo(\n    () => ({\n      drillBy: { excludedColumns: usedGroupbyColumns, openNewModal: false },\n    }),\n    [usedGroupbyColumns],\n  );\n\n  const { contextMenu, inContextMenu, onContextMenu } = useContextMenu(\n    0,\n    currentFormData,\n    onSelection,\n    ContextMenuItem.DrillBy,\n    additionalConfig,\n  );\n\n  const chartName = useSelector<RootState, string | undefined>(state => {\n    const chartLayoutItem = Object.values(state.dashboardLayout.present).find(\n      layoutItem => layoutItem.meta?.chartId === formData.slice_id,\n    );\n    return (\n      chartLayoutItem?.meta.sliceNameOverride || chartLayoutItem?.meta.sliceName\n    );\n  });\n\n  useEffect(() => {\n    if (drilledFormData) {\n      const [useLegacyApi] = getQuerySettings(drilledFormData);\n      setIsChartDataLoading(true);\n      setChartDataResult(undefined);\n      getChartDataRequest({\n        formData: drilledFormData,\n      })\n        .then(({ response, json }) =>\n          handleChartDataResponse(response, json, useLegacyApi),\n        )\n        .then(queriesResponse => {\n          setChartDataResult(queriesResponse);\n        })\n        .catch(() => {\n          addDangerToast(t('Failed to load chart data.'));\n        })\n        .finally(() => {\n          setIsChartDataLoading(false);\n        });\n    }\n  }, [addDangerToast, drilledFormData]);\n  const { metadataBar } = useDatasetMetadataBar({ dataset });\n\n  return (\n    <Modal\n      css={css`\n        .ant-modal-footer {\n          border-top: none;\n        }\n      `}\n      show\n      onHide={onHideModal ?? (() => null)}\n      title={t('Drill by: %s', chartName)}\n      footer={<ModalFooter formData={drilledFormData} />}\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '80vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n        `}\n      >\n        {metadataBar}\n        {breadcrumbs}\n        {displayModeToggle}\n        {isChartDataLoading && <Loading />}\n        {!isChartDataLoading && !chartDataResult && (\n          <Alert\n            type=\"error\"\n            message={t('There was an error loading the chart data')}\n          />\n        )}\n        {drillByDisplayMode === DrillByType.Chart && chartDataResult && (\n          <DrillByChart\n            dataset={dataset}\n            formData={drilledFormData}\n            result={chartDataResult}\n            onContextMenu={onContextMenu}\n            inContextMenu={inContextMenu}\n          />\n        )}\n        {drillByDisplayMode === DrillByType.Table &&\n          chartDataResult &&\n          resultsTable}\n        {contextMenu}\n      </div>\n    </Modal>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useMemo, useState } from 'react';\nimport { css, SupersetTheme, t } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport { DrillByType } from '../types';\n\nexport const useDisplayModeToggle = () => {\n  const [drillByDisplayMode, setDrillByDisplayMode] = useState<DrillByType>(\n    DrillByType.Chart,\n  );\n\n  const displayModeToggle = useMemo(\n    () => (\n      <div\n        css={(theme: SupersetTheme) => css`\n          margin-bottom: ${theme.gridUnit * 6}px;\n          .ant-radio-button-wrapper-checked:not(.ant-radio-button-wrapper-disabled):focus-within {\n            box-shadow: none;\n          }\n        `}\n        data-test=\"drill-by-display-toggle\"\n      >\n        <Radio.Group\n          onChange={({ target: { value } }) => {\n            setDrillByDisplayMode(value);\n          }}\n          defaultValue={DrillByType.Chart}\n        >\n          <Radio.Button\n            value={DrillByType.Chart}\n            data-test=\"drill-by-chart-radio\"\n          >\n            {t('Chart')}\n          </Radio.Button>\n          <Radio.Button\n            value={DrillByType.Table}\n            data-test=\"drill-by-table-radio\"\n          >\n            {t('Table')}\n          </Radio.Button>\n        </Radio.Group>\n      </div>\n    ),\n    [],\n  );\n  return { displayModeToggle, drillByDisplayMode };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, useRef, useState } from 'react';\nimport { BaseFormData, ContextMenuFilters } from '@superset-ui/core';\nimport ChartContextMenu, {\n  ChartContextMenuRef,\n  ContextMenuItem,\n} from './ChartContextMenu';\n\nexport const useContextMenu = (\n  chartId: number,\n  formData: BaseFormData & { [key: string]: any },\n  onSelection?: (...args: any) => void,\n  displayedItems?: ContextMenuItem[] | ContextMenuItem,\n  additionalConfig?: {\n    crossFilter?: Record<string, any>;\n    drillToDetail?: Record<string, any>;\n    drillBy?: Record<string, any>;\n  },\n) => {\n  const contextMenuRef = useRef<ChartContextMenuRef>(null);\n  const [inContextMenu, setInContextMenu] = useState(false);\n  const onContextMenu = (\n    offsetX: number,\n    offsetY: number,\n    filters: ContextMenuFilters,\n  ) => {\n    contextMenuRef.current?.open(offsetX, offsetY, filters);\n    setInContextMenu(true);\n  };\n\n  const handleContextMenuSelected = useCallback(\n    (...args: any) => {\n      setInContextMenu(false);\n      onSelection?.(...args);\n    },\n    [onSelection],\n  );\n\n  const handleContextMenuClosed = useCallback(() => {\n    setInContextMenu(false);\n  }, []);\n\n  const contextMenu = useMemo(\n    () => (\n      <ChartContextMenu\n        ref={contextMenuRef}\n        id={chartId}\n        formData={formData}\n        onSelection={handleContextMenuSelected}\n        onClose={handleContextMenuClosed}\n        displayedItems={displayedItems}\n        additionalConfig={additionalConfig}\n      />\n    ),\n    [\n      additionalConfig,\n      chartId,\n      displayedItems,\n      formData,\n      handleContextMenuClosed,\n      handleContextMenuSelected,\n    ],\n  );\n  return { contextMenu, inContextMenu, onContextMenu };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, {\n  ChangeEvent,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { Menu } from 'src/components/Menu';\nimport {\n  BaseFormData,\n  Behavior,\n  Column,\n  ContextMenuFilters,\n  css,\n  ensureIsArray,\n  getChartMetadataRegistry,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Input } from 'src/components/Input';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport Loading from 'src/components/Loading';\nimport {\n  cachedSupersetGet,\n  supersetGetCache,\n} from 'src/utils/cachedSupersetGet';\nimport { useVerboseMap } from 'src/hooks/apiResources/datasets';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\nimport DrillByModal from './DrillByModal';\nimport { getSubmenuYOffset } from '../utils';\nimport { MenuItemWithTruncation } from '../MenuItemWithTruncation';\nimport { Dataset } from '../types';\n\nconst MAX_SUBMENU_HEIGHT = 200;\nconst SHOW_COLUMNS_SEARCH_THRESHOLD = 10;\nconst SEARCH_INPUT_HEIGHT = 48;\n\nexport interface DrillByMenuItemsProps {\n  drillByConfig?: ContextMenuFilters['drillBy'];\n  formData: BaseFormData & { [key: string]: any };\n  contextMenuY?: number;\n  submenuIndex?: number;\n  onSelection?: (...args: any) => void;\n  onClick?: (event: MouseEvent) => void;\n  openNewModal?: boolean;\n  excludedColumns?: Column[];\n}\n\nexport const DrillByMenuItems = ({\n  drillByConfig,\n  formData,\n  contextMenuY = 0,\n  submenuIndex = 0,\n  onSelection = () => {},\n  onClick = () => {},\n  excludedColumns,\n  openNewModal = true,\n  ...rest\n}: DrillByMenuItemsProps) => {\n  const theme = useTheme();\n  const { addDangerToast } = useToasts();\n  const [isLoadingColumns, setIsLoadingColumns] = useState(true);\n  const [searchInput, setSearchInput] = useState('');\n  const [dataset, setDataset] = useState<Dataset>();\n  const [columns, setColumns] = useState<Column[]>([]);\n  const [showModal, setShowModal] = useState(false);\n  const [currentColumn, setCurrentColumn] = useState();\n  const handleSelection = useCallback(\n    (event, column) => {\n      onClick(event);\n      onSelection(column, drillByConfig);\n      setCurrentColumn(column);\n      if (openNewModal) {\n        setShowModal(true);\n      }\n    },\n    [drillByConfig, onClick, onSelection, openNewModal],\n  );\n  const closeModal = useCallback(() => {\n    setShowModal(false);\n  }, []);\n\n  useEffect(() => {\n    // Input is displayed only when columns.length > SHOW_COLUMNS_SEARCH_THRESHOLD\n    // Reset search input in case Input gets removed\n    setSearchInput('');\n  }, [columns.length]);\n\n  const hasDrillBy =\n    ensureIsArray(drillByConfig?.filters).length &&\n    drillByConfig?.groupbyFieldName;\n\n  const handlesDimensionContextMenu = useMemo(\n    () =>\n      getChartMetadataRegistry()\n        .get(formData.viz_type)\n        ?.behaviors.find(behavior => behavior === Behavior.DRILL_BY),\n    [formData.viz_type],\n  );\n  const verboseMap = useVerboseMap(dataset);\n\n  useEffect(() => {\n    if (handlesDimensionContextMenu && hasDrillBy) {\n      const datasetId = formData.datasource.split('__')[0];\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      })\n        .then(({ json: { result } }) => {\n          setDataset(result);\n          setColumns(\n            ensureIsArray(result.columns)\n              .filter(column => column.groupby)\n              .filter(\n                column =>\n                  !ensureIsArray(\n                    formData[drillByConfig.groupbyFieldName ?? ''],\n                  ).includes(column.column_name) &&\n                  column.column_name !== formData.x_axis &&\n                  ensureIsArray(excludedColumns)?.every(\n                    excludedCol =>\n                      excludedCol.column_name !== column.column_name,\n                  ),\n              ),\n          );\n        })\n        .catch(() => {\n          supersetGetCache.delete(`/api/v1/dataset/${datasetId}`);\n          addDangerToast(t('Failed to load dimensions for drill by'));\n        })\n        .finally(() => {\n          setIsLoadingColumns(false);\n        });\n    }\n  }, [\n    addDangerToast,\n    excludedColumns,\n    formData,\n    drillByConfig?.groupbyFieldName,\n    handlesDimensionContextMenu,\n    hasDrillBy,\n  ]);\n\n  const handleInput = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n    e.stopPropagation();\n    const input = e?.target?.value;\n    setSearchInput(input);\n  }, []);\n\n  const filteredColumns = useMemo(\n    () =>\n      columns.filter(column =>\n        (column.verbose_name || column.column_name)\n          .toLowerCase()\n          .includes(searchInput.toLowerCase()),\n      ),\n    [columns, searchInput],\n  );\n\n  const submenuYOffset = useMemo(\n    () =>\n      getSubmenuYOffset(\n        contextMenuY,\n        filteredColumns.length || 1,\n        submenuIndex,\n        MAX_SUBMENU_HEIGHT,\n        columns.length > SHOW_COLUMNS_SEARCH_THRESHOLD\n          ? SEARCH_INPUT_HEIGHT\n          : 0,\n      ),\n    [contextMenuY, filteredColumns.length, submenuIndex, columns.length],\n  );\n\n  let tooltip: ReactNode;\n\n  if (!handlesDimensionContextMenu) {\n    tooltip = t('Drill by is not yet supported for this chart type');\n  } else if (!hasDrillBy) {\n    tooltip = t('Drill by is not available for this data point');\n  }\n\n  if (!handlesDimensionContextMenu || !hasDrillBy) {\n    return (\n      <Menu.Item key=\"drill-by-disabled\" disabled {...rest}>\n        <div>\n          {t('Drill by')}\n          <MenuItemTooltip title={tooltip} />\n        </div>\n      </Menu.Item>\n    );\n  }\n\n  return (\n    <>\n      <Menu.SubMenu\n        title={t('Drill by')}\n        key=\"drill-by-submenu\"\n        popupClassName=\"chart-context-submenu\"\n        popupOffset={[0, submenuYOffset]}\n        {...rest}\n      >\n        <div data-test=\"drill-by-submenu\">\n          {columns.length > SHOW_COLUMNS_SEARCH_THRESHOLD && (\n            <Input\n              prefix={\n                <Icons.Search\n                  iconSize=\"l\"\n                  iconColor={theme.colors.grayscale.light1}\n                />\n              }\n              onChange={handleInput}\n              placeholder={t('Search columns')}\n              value={searchInput}\n              onClick={e => {\n                // prevent closing menu when clicking on input\n                e.nativeEvent.stopImmediatePropagation();\n              }}\n              allowClear\n              css={css`\n                width: auto;\n                max-width: 100%;\n                margin: ${theme.gridUnit * 2}px ${theme.gridUnit * 3}px;\n                box-shadow: none;\n              `}\n            />\n          )}\n          {isLoadingColumns ? (\n            <div\n              css={css`\n                padding: ${theme.gridUnit * 3}px 0;\n              `}\n            >\n              <Loading position=\"inline-centered\" />\n            </div>\n          ) : filteredColumns.length ? (\n            <div\n              css={css`\n                max-height: ${MAX_SUBMENU_HEIGHT}px;\n                overflow: auto;\n              `}\n            >\n              {filteredColumns.map(column => (\n                <MenuItemWithTruncation\n                  key={`drill-by-item-${column.column_name}`}\n                  tooltipText={column.verbose_name || column.column_name}\n                  {...rest}\n                  onClick={e => handleSelection(e, column)}\n                >\n                  {column.verbose_name || column.column_name}\n                </MenuItemWithTruncation>\n              ))}\n            </div>\n          ) : (\n            <Menu.Item disabled key=\"no-drill-by-columns-found\" {...rest}>\n              {t('No columns found')}\n            </Menu.Item>\n          )}\n        </div>\n      </Menu.SubMenu>\n      {showModal && (\n        <DrillByModal\n          column={currentColumn}\n          drillByConfig={drillByConfig}\n          formData={formData}\n          onHideModal={closeModal}\n          dataset={{ ...dataset!, verbose_map: verboseMap }}\n        />\n      )}\n    </>\n  );\n};\n","/* eslint-disable no-underscore-dangle */\n/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { Column, Metric, ensureIsArray } from '@superset-ui/core';\nimport { Dataset } from 'src/components/Chart/types';\n\nexport const useVerboseMap = (dataset?: Dataset) => {\n  const verbose_map = {};\n  ensureIsArray(dataset?.columns).forEach((column: Column) => {\n    verbose_map[column.column_name] = column.verbose_name || column.column_name;\n  });\n  ensureIsArray(dataset?.metrics).forEach((metric: Metric) => {\n    verbose_map[metric.metric_name] = metric.verbose_name || metric.metric_name;\n  });\n  return verbose_map;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  forwardRef,\n  ReactNode,\n  RefObject,\n  useCallback,\n  useImperativeHandle,\n  useState,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  Behavior,\n  ContextMenuFilters,\n  ensureIsArray,\n  FeatureFlag,\n  getChartMetadataRegistry,\n  isFeatureEnabled,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { RootState } from 'src/dashboard/types';\nimport { findPermission } from 'src/utils/findPermission';\nimport { Menu } from 'src/components/Menu';\nimport { AntdDropdown as Dropdown } from 'src/components/index';\nimport { updateDataMask } from 'src/dataMask/actions';\nimport { DrillDetailMenuItems } from '../DrillDetail';\nimport { getMenuAdjustedY } from '../utils';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\nimport { DrillByMenuItems } from '../DrillBy/DrillByMenuItems';\n\nexport enum ContextMenuItem {\n  CrossFilter,\n  DrillToDetail,\n  DrillBy,\n  All,\n}\nexport interface ChartContextMenuProps {\n  id: number;\n  formData: QueryFormData;\n  onSelection: () => void;\n  onClose: () => void;\n  additionalConfig?: {\n    crossFilter?: Record<string, any>;\n    drillToDetail?: Record<string, any>;\n    drillBy?: Record<string, any>;\n  };\n  displayedItems?: ContextMenuItem[] | ContextMenuItem;\n}\n\nexport interface ChartContextMenuRef {\n  open: (\n    clientX: number,\n    clientY: number,\n    filters?: ContextMenuFilters,\n  ) => void;\n}\n\nconst ChartContextMenu = (\n  {\n    id,\n    formData,\n    onSelection,\n    onClose,\n    displayedItems = ContextMenuItem.All,\n    additionalConfig,\n  }: ChartContextMenuProps,\n  ref: RefObject<ChartContextMenuRef>,\n) => {\n  const theme = useTheme();\n  const dispatch = useDispatch();\n  const canExplore = useSelector((state: RootState) =>\n    findPermission('can_explore', 'Superset', state.user?.roles),\n  );\n  const crossFiltersEnabled = useSelector<RootState, boolean>(\n    ({ dashboardInfo }) => dashboardInfo.crossFiltersEnabled,\n  );\n\n  const isDisplayed = (item: ContextMenuItem) =>\n    displayedItems === ContextMenuItem.All ||\n    ensureIsArray(displayedItems).includes(item);\n\n  const [{ filters, clientX, clientY }, setState] = useState<{\n    clientX: number;\n    clientY: number;\n    filters?: ContextMenuFilters;\n  }>({ clientX: 0, clientY: 0 });\n\n  const menuItems = [];\n\n  const showDrillToDetail =\n    isFeatureEnabled(FeatureFlag.DRILL_TO_DETAIL) &&\n    canExplore &&\n    isDisplayed(ContextMenuItem.DrillToDetail);\n\n  const showDrillBy =\n    isFeatureEnabled(FeatureFlag.DRILL_BY) &&\n    canExplore &&\n    isDisplayed(ContextMenuItem.DrillBy);\n\n  const showCrossFilters =\n    isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS) &&\n    isDisplayed(ContextMenuItem.CrossFilter);\n\n  const isCrossFilteringSupportedByChart = getChartMetadataRegistry()\n    .get(formData.viz_type)\n    ?.behaviors?.includes(Behavior.INTERACTIVE_CHART);\n\n  let itemsCount = 0;\n  if (showCrossFilters) {\n    itemsCount += 1;\n  }\n  if (showDrillToDetail) {\n    itemsCount += 2; // Drill to detail always has 2 top-level menu items\n  }\n  if (showDrillBy) {\n    itemsCount += 1;\n  }\n  if (itemsCount === 0) {\n    itemsCount = 1; // \"No actions\" appears if no actions in menu\n  }\n\n  if (showCrossFilters) {\n    const isCrossFilterDisabled =\n      !isCrossFilteringSupportedByChart ||\n      !crossFiltersEnabled ||\n      !filters?.crossFilter;\n\n    let crossFilteringTooltipTitle: ReactNode = null;\n    if (!isCrossFilterDisabled) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>\n            {t(\n              'Cross-filter will be applied to all of the charts that use this dataset.',\n            )}\n          </div>\n          <div>\n            {t('You can also just click on the chart to apply cross-filter.')}\n          </div>\n        </>\n      );\n    } else if (!crossFiltersEnabled) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>{t('Cross-filtering is not enabled for this dashboard.')}</div>\n        </>\n      );\n    } else if (!isCrossFilteringSupportedByChart) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>\n            {t('This visualization type does not support cross-filtering.')}\n          </div>\n        </>\n      );\n    } else if (!filters?.crossFilter) {\n      crossFilteringTooltipTitle = (\n        <>\n          <div>{t(`You can't apply cross-filter on this data point.`)}</div>\n        </>\n      );\n    }\n    menuItems.push(\n      <>\n        <Menu.Item\n          key=\"cross-filtering-menu-item\"\n          disabled={isCrossFilterDisabled}\n          onClick={() => {\n            if (filters?.crossFilter) {\n              dispatch(updateDataMask(id, filters.crossFilter.dataMask));\n            }\n          }}\n        >\n          {filters?.crossFilter?.isCurrentValueSelected ? (\n            t('Remove cross-filter')\n          ) : (\n            <div>\n              {t('Add cross-filter')}\n              <MenuItemTooltip\n                title={crossFilteringTooltipTitle}\n                color={\n                  !isCrossFilterDisabled\n                    ? theme.colors.grayscale.base\n                    : undefined\n                }\n              />\n            </div>\n          )}\n        </Menu.Item>\n        {itemsCount > 1 && <Menu.Divider />}\n      </>,\n    );\n  }\n  if (showDrillToDetail) {\n    menuItems.push(\n      <DrillDetailMenuItems\n        chartId={id}\n        formData={formData}\n        filters={filters?.drillToDetail}\n        isContextMenu\n        contextMenuY={clientY}\n        onSelection={onSelection}\n        submenuIndex={showCrossFilters ? 2 : 1}\n        {...(additionalConfig?.drillToDetail || {})}\n      />,\n    );\n  }\n  if (showDrillBy) {\n    let submenuIndex = 0;\n    if (showCrossFilters) {\n      submenuIndex += 1;\n    }\n    if (showDrillToDetail) {\n      submenuIndex += 2;\n    }\n    menuItems.push(\n      <DrillByMenuItems\n        drillByConfig={filters?.drillBy}\n        onSelection={onSelection}\n        formData={formData}\n        contextMenuY={clientY}\n        submenuIndex={submenuIndex}\n        {...(additionalConfig?.drillBy || {})}\n      />,\n    );\n  }\n\n  const open = useCallback(\n    (clientX: number, clientY: number, filters?: ContextMenuFilters) => {\n      const adjustedY = getMenuAdjustedY(clientY, itemsCount);\n      setState({\n        clientX,\n        clientY: adjustedY,\n        filters,\n      });\n\n      // Since Ant Design's Dropdown does not offer an imperative API\n      // and we can't attach event triggers to charts SVG elements, we\n      // use a hidden span that gets clicked on when receiving click events\n      // from the charts.\n      document.getElementById(`hidden-span-${id}`)?.click();\n    },\n    [id, itemsCount],\n  );\n\n  useImperativeHandle(\n    ref,\n    () => ({\n      open,\n    }),\n    [open],\n  );\n\n  return ReactDOM.createPortal(\n    <Dropdown\n      overlay={\n        <Menu className=\"chart-context-menu\" data-test=\"chart-context-menu\">\n          {menuItems.length ? (\n            menuItems\n          ) : (\n            <Menu.Item disabled>No actions</Menu.Item>\n          )}\n        </Menu>\n      }\n      trigger={['click']}\n      onVisibleChange={value => !value && onClose()}\n    >\n      <span\n        id={`hidden-span-${id}`}\n        css={{\n          visibility: 'hidden',\n          position: 'fixed',\n          top: clientY,\n          left: clientX,\n          width: 1,\n          height: 1,\n        }}\n      />\n    </Dropdown>,\n    document.body,\n  );\n};\n\nexport default forwardRef(ChartContextMenu);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { snakeCase, isEqual, cloneDeep } from 'lodash';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {\n  SuperChart,\n  logging,\n  Behavior,\n  t,\n  isFeatureEnabled,\n  FeatureFlag,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { EmptyStateBig, EmptyStateSmall } from 'src/components/EmptyState';\nimport { ChartSource } from 'src/types/ChartSource';\nimport ChartContextMenu from './ChartContextMenu/ChartContextMenu';\n\nconst propTypes = {\n  annotationData: PropTypes.object,\n  actions: PropTypes.object,\n  chartId: PropTypes.number.isRequired,\n  datasource: PropTypes.object,\n  initialValues: PropTypes.object,\n  formData: PropTypes.object.isRequired,\n  latestQueryFormData: PropTypes.object,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  height: PropTypes.number,\n  width: PropTypes.number,\n  setControlValue: PropTypes.func,\n  vizType: PropTypes.string.isRequired,\n  triggerRender: PropTypes.bool,\n  // state\n  chartAlert: PropTypes.string,\n  chartStatus: PropTypes.string,\n  queriesResponse: PropTypes.arrayOf(PropTypes.object),\n  triggerQuery: PropTypes.bool,\n  chartIsStale: PropTypes.bool,\n  // dashboard callbacks\n  addFilter: PropTypes.func,\n  setDataMask: PropTypes.func,\n  onFilterMenuOpen: PropTypes.func,\n  onFilterMenuClose: PropTypes.func,\n  ownState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  source: PropTypes.oneOf([ChartSource.Dashboard, ChartSource.Explore]),\n  emitCrossFilters: PropTypes.bool,\n};\n\nconst BLANK = {};\n\nconst BIG_NO_RESULT_MIN_WIDTH = 300;\nconst BIG_NO_RESULT_MIN_HEIGHT = 220;\n\nconst behaviors = [Behavior.INTERACTIVE_CHART];\n\nconst defaultProps = {\n  addFilter: () => BLANK,\n  onFilterMenuOpen: () => BLANK,\n  onFilterMenuClose: () => BLANK,\n  initialValues: BLANK,\n  setControlValue() {},\n  triggerRender: false,\n};\n\nclass ChartRenderer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showContextMenu:\n        props.source === ChartSource.Dashboard &&\n        (isFeatureEnabled(FeatureFlag.DRILL_TO_DETAIL) ||\n          isFeatureEnabled(FeatureFlag.DASHBOARD_CROSS_FILTERS)),\n      inContextMenu: false,\n      legendState: undefined,\n    };\n    this.hasQueryResponseChange = false;\n\n    this.contextMenuRef = React.createRef();\n\n    this.handleAddFilter = this.handleAddFilter.bind(this);\n    this.handleRenderSuccess = this.handleRenderSuccess.bind(this);\n    this.handleRenderFailure = this.handleRenderFailure.bind(this);\n    this.handleSetControlValue = this.handleSetControlValue.bind(this);\n    this.handleOnContextMenu = this.handleOnContextMenu.bind(this);\n    this.handleContextMenuSelected = this.handleContextMenuSelected.bind(this);\n    this.handleContextMenuClosed = this.handleContextMenuClosed.bind(this);\n    this.handleLegendStateChanged = this.handleLegendStateChanged.bind(this);\n    this.onContextMenuFallback = this.onContextMenuFallback.bind(this);\n\n    this.hooks = {\n      onAddFilter: this.handleAddFilter,\n      onContextMenu: this.state.showContextMenu\n        ? this.handleOnContextMenu\n        : undefined,\n      onError: this.handleRenderFailure,\n      setControlValue: this.handleSetControlValue,\n      onFilterMenuOpen: this.props.onFilterMenuOpen,\n      onFilterMenuClose: this.props.onFilterMenuClose,\n      onLegendStateChanged: this.handleLegendStateChanged,\n      setDataMask: dataMask => {\n        this.props.actions?.updateDataMask(this.props.chartId, dataMask);\n      },\n    };\n\n    // TODO: queriesResponse comes from Redux store but it's being edited by\n    // the plugins, hence we need to clone it to avoid state mutation\n    // until we change the reducers to use Redux Toolkit with Immer\n    this.mutableQueriesResponse = cloneDeep(this.props.queriesResponse);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const resultsReady =\n      nextProps.queriesResponse &&\n      ['success', 'rendered'].indexOf(nextProps.chartStatus) > -1 &&\n      !nextProps.queriesResponse?.[0]?.error;\n\n    if (resultsReady) {\n      if (!isEqual(this.state, nextState)) {\n        return true;\n      }\n      this.hasQueryResponseChange =\n        nextProps.queriesResponse !== this.props.queriesResponse;\n\n      if (this.hasQueryResponseChange) {\n        this.mutableQueriesResponse = cloneDeep(nextProps.queriesResponse);\n      }\n\n      return (\n        this.hasQueryResponseChange ||\n        !isEqual(nextProps.datasource, this.props.datasource) ||\n        nextProps.annotationData !== this.props.annotationData ||\n        nextProps.ownState !== this.props.ownState ||\n        nextProps.filterState !== this.props.filterState ||\n        nextProps.height !== this.props.height ||\n        nextProps.width !== this.props.width ||\n        nextProps.triggerRender ||\n        nextProps.labelColors !== this.props.labelColors ||\n        nextProps.sharedLabelColors !== this.props.sharedLabelColors ||\n        nextProps.formData.color_scheme !== this.props.formData.color_scheme ||\n        nextProps.formData.stack !== this.props.formData.stack ||\n        nextProps.cacheBusterProp !== this.props.cacheBusterProp ||\n        nextProps.emitCrossFilters !== this.props.emitCrossFilters\n      );\n    }\n    return false;\n  }\n\n  handleAddFilter(col, vals, merge = true, refresh = true) {\n    this.props.addFilter(col, vals, merge, refresh);\n  }\n\n  handleRenderSuccess() {\n    const { actions, chartStatus, chartId, vizType } = this.props;\n    if (['loading', 'rendered'].indexOf(chartStatus) < 0) {\n      actions.chartRenderingSucceeded(chartId);\n    }\n\n    // only log chart render time which is triggered by query results change\n    // currently we don't log chart re-render time, like window resize etc\n    if (this.hasQueryResponseChange) {\n      actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n        slice_id: chartId,\n        viz_type: vizType,\n        start_offset: this.renderStartTime,\n        ts: new Date().getTime(),\n        duration: Logger.getTimestamp() - this.renderStartTime,\n      });\n    }\n  }\n\n  handleRenderFailure(error, info) {\n    const { actions, chartId } = this.props;\n    logging.warn(error);\n    actions.chartRenderingFailed(\n      error.toString(),\n      chartId,\n      info ? info.componentStack : null,\n    );\n\n    // only trigger render log when query is changed\n    if (this.hasQueryResponseChange) {\n      actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n        slice_id: chartId,\n        has_err: true,\n        error_details: error.toString(),\n        start_offset: this.renderStartTime,\n        ts: new Date().getTime(),\n        duration: Logger.getTimestamp() - this.renderStartTime,\n      });\n    }\n  }\n\n  handleSetControlValue(...args) {\n    const { setControlValue } = this.props;\n    if (setControlValue) {\n      setControlValue(...args);\n    }\n  }\n\n  handleOnContextMenu(offsetX, offsetY, filters) {\n    this.contextMenuRef.current.open(offsetX, offsetY, filters);\n    this.setState({ inContextMenu: true });\n  }\n\n  handleContextMenuSelected() {\n    this.setState({ inContextMenu: false });\n  }\n\n  handleContextMenuClosed() {\n    this.setState({ inContextMenu: false });\n  }\n\n  handleLegendStateChanged(legendState) {\n    this.setState({ legendState });\n  }\n\n  // When viz plugins don't handle `contextmenu` event, fallback handler\n  // calls `handleOnContextMenu` with no `filters` param.\n  onContextMenuFallback(event) {\n    if (!this.state.inContextMenu) {\n      event.preventDefault();\n      this.handleOnContextMenu(event.clientX, event.clientY);\n    }\n  }\n\n  render() {\n    const { chartAlert, chartStatus, chartId, emitCrossFilters } = this.props;\n\n    // Skip chart rendering\n    if (chartStatus === 'loading' || !!chartAlert || chartStatus === null) {\n      return null;\n    }\n\n    this.renderStartTime = Logger.getTimestamp();\n\n    const {\n      width,\n      height,\n      datasource,\n      annotationData,\n      initialValues,\n      ownState,\n      filterState,\n      chartIsStale,\n      formData,\n      latestQueryFormData,\n      postTransformProps,\n    } = this.props;\n\n    const currentFormData =\n      chartIsStale && latestQueryFormData ? latestQueryFormData : formData;\n    const vizType = currentFormData.viz_type || this.props.vizType;\n\n    // It's bad practice to use unprefixed `vizType` as classnames for chart\n    // container. It may cause css conflicts as in the case of legacy table chart.\n    // When migrating charts, we should gradually add a `superset-chart-` prefix\n    // to each one of them.\n    const snakeCaseVizType = snakeCase(vizType);\n    const chartClassName =\n      vizType === 'table'\n        ? `superset-chart-${snakeCaseVizType}`\n        : snakeCaseVizType;\n\n    const webpackHash =\n      process.env.WEBPACK_MODE === 'development'\n        ? `-${\n            // eslint-disable-next-line camelcase\n            typeof __webpack_require__ !== 'undefined' &&\n            // eslint-disable-next-line camelcase, no-undef\n            typeof __webpack_require__.h === 'function' &&\n            // eslint-disable-next-line no-undef\n            __webpack_require__.h()\n          }`\n        : '';\n\n    let noResultsComponent;\n    const noResultTitle = t('No results were returned for this query');\n    const noResultDescription =\n      this.props.source === ChartSource.Explore\n        ? t(\n            'Make sure that the controls are configured properly and the datasource contains data for the selected time range',\n          )\n        : undefined;\n    const noResultImage = 'chart.svg';\n    if (width > BIG_NO_RESULT_MIN_WIDTH && height > BIG_NO_RESULT_MIN_HEIGHT) {\n      noResultsComponent = (\n        <EmptyStateBig\n          title={noResultTitle}\n          description={noResultDescription}\n          image={noResultImage}\n        />\n      );\n    } else {\n      noResultsComponent = (\n        <EmptyStateSmall title={noResultTitle} image={noResultImage} />\n      );\n    }\n\n    // Check for Behavior.DRILL_TO_DETAIL to tell if chart can receive Drill to\n    // Detail props or if it'll cause side-effects (e.g. excessive re-renders).\n    const drillToDetailProps = getChartMetadataRegistry()\n      .get(formData.viz_type)\n      ?.behaviors.find(behavior => behavior === Behavior.DRILL_TO_DETAIL)\n      ? { inContextMenu: this.state.inContextMenu }\n      : {};\n\n    return (\n      <>\n        {this.state.showContextMenu && (\n          <ChartContextMenu\n            ref={this.contextMenuRef}\n            id={chartId}\n            formData={currentFormData}\n            onSelection={this.handleContextMenuSelected}\n            onClose={this.handleContextMenuClosed}\n          />\n        )}\n        <div\n          onContextMenu={\n            this.state.showContextMenu ? this.onContextMenuFallback : undefined\n          }\n        >\n          <SuperChart\n            disableErrorBoundary\n            key={`${chartId}${webpackHash}`}\n            id={`chart-id-${chartId}`}\n            className={chartClassName}\n            chartType={vizType}\n            width={width}\n            height={height}\n            annotationData={annotationData}\n            datasource={datasource}\n            initialValues={initialValues}\n            formData={currentFormData}\n            ownState={ownState}\n            filterState={filterState}\n            hooks={this.hooks}\n            behaviors={behaviors}\n            queriesData={this.mutableQueriesResponse}\n            onRenderSuccess={this.handleRenderSuccess}\n            onRenderFailure={this.handleRenderFailure}\n            noResults={noResultsComponent}\n            postTransformProps={postTransformProps}\n            emitCrossFilters={emitCrossFilters}\n            legendState={this.state.legendState}\n            {...drillToDetailProps}\n          />\n        </div>\n      </>\n    );\n  }\n}\n\nChartRenderer.propTypes = propTypes;\nChartRenderer.defaultProps = defaultProps;\n\nexport default ChartRenderer;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React from 'react';\nimport { useChartOwnerNames } from 'src/hooks/apiResources';\nimport ErrorMessageWithStackTrace from 'src/components/ErrorMessage/ErrorMessageWithStackTrace';\nimport { SupersetError } from 'src/components/ErrorMessage/types';\n\ninterface Props {\n  chartId: string;\n  error?: SupersetError;\n}\n\n/**\n * fetches the chart owners and adds them to the extra data of the error message\n */\nexport const ChartErrorMessage: React.FC<Props> = ({\n  chartId,\n  error,\n  ...props\n}) => {\n  const { result: owners } = useChartOwnerNames(chartId);\n\n  // don't mutate props\n  const ownedError = error && {\n    ...error,\n    extra: { ...error.extra, owners },\n  };\n\n  return <ErrorMessageWithStackTrace {...props} error={ownedError} />;\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport {\n  ensureIsArray,\n  FeatureFlag,\n  isFeatureEnabled,\n  logging,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { PLACEHOLDER_DATASOURCE } from 'src/dashboard/constants';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateBig } from 'src/components/EmptyState';\nimport ErrorBoundary from 'src/components/ErrorBoundary';\nimport { Logger, LOG_ACTIONS_RENDER_CHART } from 'src/logger/LogUtils';\nimport { URL_PARAMS } from 'src/constants';\nimport { getUrlParam } from 'src/utils/urlUtils';\nimport { isCurrentUserBot } from 'src/utils/isBot';\nimport { ChartSource } from 'src/types/ChartSource';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport ChartRenderer from './ChartRenderer';\nimport { ChartErrorMessage } from './ChartErrorMessage';\nimport { getChartRequiredFieldsMissingMessage } from '../../utils/getChartRequiredFieldsMissingMessage';\n\nconst propTypes = {\n  annotationData: PropTypes.object,\n  actions: PropTypes.object,\n  chartId: PropTypes.number.isRequired,\n  datasource: PropTypes.object,\n  // current chart is included by dashboard\n  dashboardId: PropTypes.number,\n  // original selected values for FilterBox viz\n  // so that FilterBox can pre-populate selected values\n  // only affect UI control\n  initialValues: PropTypes.object,\n  // formData contains chart's own filter parameter\n  // and merged with extra filter that current dashboard applying\n  formData: PropTypes.object.isRequired,\n  labelColors: PropTypes.object,\n  sharedLabelColors: PropTypes.object,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  setControlValue: PropTypes.func,\n  timeout: PropTypes.number,\n  vizType: PropTypes.string.isRequired,\n  triggerRender: PropTypes.bool,\n  force: PropTypes.bool,\n  isFiltersInitialized: PropTypes.bool,\n  // state\n  chartAlert: PropTypes.string,\n  chartStatus: PropTypes.string,\n  chartStackTrace: PropTypes.string,\n  queriesResponse: PropTypes.arrayOf(PropTypes.object),\n  triggerQuery: PropTypes.bool,\n  chartIsStale: PropTypes.bool,\n  errorMessage: PropTypes.node,\n  // dashboard callbacks\n  addFilter: PropTypes.func,\n  onQuery: PropTypes.func,\n  onFilterMenuOpen: PropTypes.func,\n  onFilterMenuClose: PropTypes.func,\n  ownState: PropTypes.object,\n  postTransformProps: PropTypes.func,\n  datasetsStatus: PropTypes.oneOf(['loading', 'error', 'complete']),\n  isInView: PropTypes.bool,\n  emitCrossFilters: PropTypes.bool,\n};\n\nconst BLANK = {};\nconst NONEXISTENT_DATASET = t(\n  'The dataset associated with this chart no longer exists',\n);\n\nconst defaultProps = {\n  addFilter: () => BLANK,\n  onFilterMenuOpen: () => BLANK,\n  onFilterMenuClose: () => BLANK,\n  initialValues: BLANK,\n  setControlValue() {},\n  triggerRender: false,\n  dashboardId: null,\n  chartStackTrace: null,\n  force: false,\n  isInView: true,\n};\n\nconst Styles = styled.div`\n  min-height: ${p => p.height}px;\n  position: relative;\n\n  .chart-tooltip {\n    opacity: 0.75;\n    font-size: ${({ theme }) => theme.typography.sizes.s}px;\n  }\n\n  .slice_container {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    height: ${p => p.height}px;\n\n    .pivot_table tbody tr {\n      font-feature-settings: 'tnum' 1;\n    }\n\n    .alert {\n      margin: ${({ theme }) => theme.gridUnit * 2}px;\n    }\n  }\n`;\n\nconst MonospaceDiv = styled.div`\n  font-family: ${({ theme }) => theme.typography.families.monospace};\n  word-break: break-word;\n  overflow-x: auto;\n  white-space: pre-wrap;\n`;\n\nclass Chart extends React.PureComponent {\n  constructor(props) {\n    super(props);\n    this.handleRenderContainerFailure =\n      this.handleRenderContainerFailure.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.triggerQuery) {\n      this.runQuery();\n    }\n  }\n\n  componentDidUpdate() {\n    if (this.props.triggerQuery) {\n      this.runQuery();\n    }\n  }\n\n  runQuery() {\n    if (this.props.chartId > 0 && isFeatureEnabled(FeatureFlag.CLIENT_CACHE)) {\n      // Load saved chart with a GET request\n      this.props.actions.getSavedChart(\n        this.props.formData,\n        this.props.force || getUrlParam(URL_PARAMS.force), // allow override via url params force=true\n        this.props.timeout,\n        this.props.chartId,\n        this.props.dashboardId,\n        this.props.ownState,\n      );\n    } else {\n      // Create chart with POST request\n      this.props.actions.postChartFormData(\n        this.props.formData,\n        Boolean(this.props.force || getUrlParam(URL_PARAMS.force)), // allow override via url params force=true\n        this.props.timeout,\n        this.props.chartId,\n        this.props.dashboardId,\n        this.props.ownState,\n      );\n    }\n  }\n\n  handleRenderContainerFailure(error, info) {\n    const { actions, chartId } = this.props;\n    logging.warn(error);\n    actions.chartRenderingFailed(\n      error.toString(),\n      chartId,\n      info ? info.componentStack : null,\n    );\n\n    actions.logEvent(LOG_ACTIONS_RENDER_CHART, {\n      slice_id: chartId,\n      has_err: true,\n      error_details: error.toString(),\n      start_offset: this.renderStartTime,\n      ts: new Date().getTime(),\n      duration: Logger.getTimestamp() - this.renderStartTime,\n    });\n  }\n\n  renderErrorMessage(queryResponse) {\n    const {\n      chartId,\n      chartAlert,\n      chartStackTrace,\n      datasource,\n      dashboardId,\n      height,\n      datasetsStatus,\n    } = this.props;\n    const error = queryResponse?.errors?.[0];\n    const message = chartAlert || queryResponse?.message;\n\n    // if datasource is still loading, don't render JS errors\n    if (\n      chartAlert !== undefined &&\n      chartAlert !== NONEXISTENT_DATASET &&\n      datasource === PLACEHOLDER_DATASOURCE &&\n      datasetsStatus !== ResourceStatus.ERROR\n    ) {\n      return (\n        <Styles\n          key={chartId}\n          data-ui-anchor=\"chart\"\n          className=\"chart-container\"\n          data-test=\"chart-container\"\n          height={height}\n        >\n          <Loading />\n        </Styles>\n      );\n    }\n\n    return (\n      <ChartErrorMessage\n        key={chartId}\n        chartId={chartId}\n        error={error}\n        subtitle={<MonospaceDiv>{message}</MonospaceDiv>}\n        copyText={message}\n        link={queryResponse ? queryResponse.link : null}\n        source={dashboardId ? ChartSource.Dashboard : ChartSource.Explore}\n        stackTrace={chartStackTrace}\n      />\n    );\n  }\n\n  render() {\n    const {\n      height,\n      chartAlert,\n      chartStatus,\n      errorMessage,\n      chartIsStale,\n      queriesResponse = [],\n      width,\n    } = this.props;\n\n    const isLoading = chartStatus === 'loading';\n    this.renderContainerStartTime = Logger.getTimestamp();\n    if (chartStatus === 'failed') {\n      return queriesResponse.map(item => this.renderErrorMessage(item));\n    }\n\n    if (errorMessage && ensureIsArray(queriesResponse).length === 0) {\n      return (\n        <EmptyStateBig\n          title={t('Add required control values to preview chart')}\n          description={getChartRequiredFieldsMissingMessage(true)}\n          image=\"chart.svg\"\n        />\n      );\n    }\n\n    if (\n      !isLoading &&\n      !chartAlert &&\n      !errorMessage &&\n      chartIsStale &&\n      ensureIsArray(queriesResponse).length === 0\n    ) {\n      return (\n        <EmptyStateBig\n          title={t('Your chart is ready to go!')}\n          description={\n            <span>\n              {t(\n                'Click on \"Create chart\" button in the control panel on the left to preview a visualization or',\n              )}{' '}\n              <span role=\"button\" tabIndex={0} onClick={this.props.onQuery}>\n                {t('click here')}\n              </span>\n              .\n            </span>\n          }\n          image=\"chart.svg\"\n        />\n      );\n    }\n\n    return (\n      <ErrorBoundary\n        onError={this.handleRenderContainerFailure}\n        showMessage={false}\n      >\n        <Styles\n          data-ui-anchor=\"chart\"\n          className=\"chart-container\"\n          data-test=\"chart-container\"\n          height={height}\n          width={width}\n        >\n          <div className=\"slice_container\" data-test=\"slice-container\">\n            {this.props.isInView ||\n            !isFeatureEnabled(FeatureFlag.DASHBOARD_VIRTUALIZATION) ||\n            isCurrentUserBot() ? (\n              <ChartRenderer\n                {...this.props}\n                source={this.props.dashboardId ? 'dashboard' : 'explore'}\n                data-test={this.props.vizType}\n              />\n            ) : (\n              <Loading />\n            )}\n          </div>\n          {isLoading && <Loading />}\n        </Styles>\n      </ErrorBoundary>\n    );\n  }\n}\n\nChart.propTypes = propTypes;\nChart.defaultProps = defaultProps;\n\nexport default Chart;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport * as actions from './chartAction';\nimport { logEvent } from '../../logger/actions';\nimport Chart from './Chart';\nimport { updateDataMask } from '../../dataMask/actions';\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    actions: bindActionCreators(\n      {\n        ...actions,\n        updateDataMask,\n        logEvent,\n      },\n      dispatch,\n    ),\n  };\n}\n\nexport default connect(null, mapDispatchToProps)(Chart);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { css, styled, t } from '@superset-ui/core';\nimport { Input, TextArea } from 'src/components/Input';\nimport CopyToClipboard from 'src/components/CopyToClipboard';\nimport { URL_PARAMS } from 'src/constants';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport { CopyButton } from './DataTableControl';\n\nconst CopyButtonEmbedCode = styled(CopyButton)`\n  && {\n    margin: 0 0 ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst EmbedCodeContent = ({ formData, addDangerToast }) => {\n  const [height, setHeight] = useState('400');\n  const [width, setWidth] = useState('600');\n  const [url, setUrl] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const handleInputChange = useCallback(e => {\n    const { value, name } = e.currentTarget;\n    if (name === 'width') {\n      setWidth(value);\n    }\n    if (name === 'height') {\n      setHeight(value);\n    }\n  }, []);\n\n  const updateUrl = useCallback(() => {\n    setUrl('');\n    getChartPermalink(formData)\n      .then(url => {\n        setUrl(url);\n        setErrorMessage('');\n      })\n      .catch(() => {\n        setErrorMessage(t('Error'));\n        addDangerToast(t('Sorry, something went wrong. Try again later.'));\n      });\n  }, [addDangerToast, formData]);\n\n  useEffect(() => {\n    updateUrl();\n  }, []);\n\n  const html = useMemo(() => {\n    if (!url) return '';\n    const srcLink = `${url}?${URL_PARAMS.standalone.name}=1&height=${height}`;\n    return (\n      '<iframe\\n' +\n      `  width=\"${width}\"\\n` +\n      `  height=\"${height}\"\\n` +\n      '  seamless\\n' +\n      '  frameBorder=\"0\"\\n' +\n      '  scrolling=\"no\"\\n' +\n      `  src=\"${srcLink}\"\\n` +\n      '>\\n' +\n      '</iframe>'\n    );\n  }, [height, url, width]);\n\n  const text = errorMessage || html || t('Generating link, please wait..');\n  return (\n    <div id=\"embed-code-popover\" data-test=\"embed-code-popover\">\n      <div\n        css={css`\n          display: flex;\n          flex-direction: column;\n        `}\n      >\n        <CopyToClipboard\n          shouldShowText={false}\n          text={html}\n          copyNode={\n            <CopyButtonEmbedCode buttonSize=\"xsmall\">\n              <i className=\"fa fa-clipboard\" />\n            </CopyButtonEmbedCode>\n          }\n        />\n        <TextArea\n          data-test=\"embed-code-textarea\"\n          name=\"embedCode\"\n          disabled={!html}\n          value={text}\n          rows=\"4\"\n          readOnly\n          css={theme => css`\n            resize: vertical;\n            padding: ${theme.gridUnit * 2}px;\n            font-size: ${theme.typography.sizes.s}px;\n            border-radius: 4px;\n            background-color: ${theme.colors.secondary.light5};\n          `}\n        />\n      </div>\n      <div\n        css={theme => css`\n          display: flex;\n          margin-top: ${theme.gridUnit * 4}px;\n          & > div {\n            margin-right: ${theme.gridUnit * 2}px;\n          }\n          & > div:last-of-type {\n            margin-right: 0;\n            margin-left: ${theme.gridUnit * 2}px;\n          }\n        `}\n      >\n        <div>\n          <label htmlFor=\"embed-height\">{t('Chart height')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={height}\n            name=\"height\"\n            onChange={handleInputChange}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"embed-width\">{t('Chart width')}</label>\n          <Input\n            type=\"text\"\n            defaultValue={width}\n            name=\"width\"\n            onChange={handleInputChange}\n            id=\"embed-width\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default EmbedCodeContent;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport { Input } from 'src/components/Input';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport { Link } from 'react-router-dom';\n\nexport interface DashboardsSubMenuProps {\n  chartId?: number;\n  dashboards?: { id: number; dashboard_title: string }[];\n}\n\nconst WIDTH = 220;\nconst HEIGHT = 300;\nconst SEARCH_THRESHOLD = 10;\n\nconst DashboardsSubMenu = ({\n  chartId,\n  dashboards = [],\n  ...menuProps\n}: DashboardsSubMenuProps) => {\n  const theme = useTheme();\n  const [dashboardSearch, setDashboardSearch] = useState<string>();\n  const [hoveredItem, setHoveredItem] = useState<number | null>();\n  const showSearch = dashboards.length > SEARCH_THRESHOLD;\n  const filteredDashboards = dashboards.filter(\n    dashboard =>\n      !dashboardSearch ||\n      dashboard.dashboard_title\n        .toLowerCase()\n        .includes(dashboardSearch.toLowerCase()),\n  );\n  const noResults = dashboards.length === 0;\n  const noResultsFound = dashboardSearch && filteredDashboards.length === 0;\n  const urlQueryString = chartId ? `?focused_chart=${chartId}` : '';\n  return (\n    <>\n      {showSearch && (\n        <Input\n          allowClear\n          placeholder={t('Search')}\n          prefix={<Icons.Search iconSize=\"l\" />}\n          css={css`\n            width: ${WIDTH}px;\n            margin: ${theme.gridUnit * 2}px ${theme.gridUnit * 3}px;\n          `}\n          value={dashboardSearch}\n          onChange={e => setDashboardSearch(e.currentTarget.value)}\n        />\n      )}\n      <div\n        css={css`\n          max-height: ${HEIGHT}px;\n          overflow: auto;\n        `}\n      >\n        {filteredDashboards.map(dashboard => (\n          <Menu.Item\n            key={String(dashboard.id)}\n            onMouseEnter={() => setHoveredItem(dashboard.id)}\n            onMouseLeave={() => {\n              if (hoveredItem === dashboard.id) {\n                setHoveredItem(null);\n              }\n            }}\n            {...menuProps}\n          >\n            <Link\n              target=\"_blank\"\n              rel=\"noreferer noopener\"\n              to={`/superset/dashboard/${dashboard.id}${urlQueryString}`}\n            >\n              <div\n                css={css`\n                  display: flex;\n                  flex-direction: row;\n                  align-items: center;\n                  max-width: ${WIDTH}px;\n                `}\n              >\n                <div\n                  css={css`\n                    white-space: normal;\n                  `}\n                >\n                  {dashboard.dashboard_title}\n                </div>\n                <Icons.Full\n                  iconSize=\"l\"\n                  iconColor={theme.colors.grayscale.base}\n                  css={css`\n                    margin-left: ${theme.gridUnit * 2}px;\n                    visibility: ${hoveredItem === dashboard.id\n                      ? 'visible'\n                      : 'hidden'};\n                  `}\n                />\n              </div>\n            </Link>\n          </Menu.Item>\n        ))}\n        {noResultsFound && (\n          <div\n            css={css`\n              margin-left: ${theme.gridUnit * 3}px;\n              margin-bottom: ${theme.gridUnit}px;\n            `}\n          >\n            {t('No results found')}\n          </div>\n        )}\n        {noResults && (\n          <Menu.Item\n            disabled\n            css={css`\n              min-width: ${WIDTH}px;\n            `}\n            {...menuProps}\n          >\n            {t('None')}\n          </Menu.Item>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default DashboardsSubMenu;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useCallback, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  css,\n  isFeatureEnabled,\n  FeatureFlag,\n  styled,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Menu } from 'src/components/Menu';\nimport ModalTrigger from 'src/components/ModalTrigger';\nimport Button from 'src/components/Button';\nimport { useToasts } from 'src/components/MessageToasts/withToasts';\nimport { exportChart, getChartKey } from 'src/explore/exploreUtils';\nimport downloadAsImage from 'src/utils/downloadAsImage';\nimport { getChartPermalink } from 'src/utils/urlUtils';\nimport copyTextToClipboard from 'src/utils/copy';\nimport HeaderReportDropDown from 'src/features/reports/ReportModal/HeaderReportDropdown';\nimport { logEvent } from 'src/logger/actions';\nimport {\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED,\n  LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS,\n} from 'src/logger/LogUtils';\nimport ViewQueryModal from '../controls/ViewQueryModal';\nimport EmbedCodeContent from '../EmbedCodeContent';\nimport DashboardsSubMenu from './DashboardsSubMenu';\n\nconst MENU_KEYS = {\n  EDIT_PROPERTIES: 'edit_properties',\n  DASHBOARDS_ADDED_TO: 'dashboards_added_to',\n  DOWNLOAD_SUBMENU: 'download_submenu',\n  EXPORT_TO_CSV: 'export_to_csv',\n  EXPORT_TO_CSV_PIVOTED: 'export_to_csv_pivoted',\n  EXPORT_TO_JSON: 'export_to_json',\n  EXPORT_TO_XLSX: 'export_to_xlsx',\n  DOWNLOAD_AS_IMAGE: 'download_as_image',\n  SHARE_SUBMENU: 'share_submenu',\n  COPY_PERMALINK: 'copy_permalink',\n  EMBED_CODE: 'embed_code',\n  SHARE_BY_EMAIL: 'share_by_email',\n  REPORT_SUBMENU: 'report_submenu',\n  SET_UP_REPORT: 'set_up_report',\n  SET_REPORT_ACTIVE: 'set_report_active',\n  EDIT_REPORT: 'edit_report',\n  DELETE_REPORT: 'delete_report',\n  VIEW_QUERY: 'view_query',\n  RUN_IN_SQL_LAB: 'run_in_sql_lab',\n};\n\nconst VIZ_TYPES_PIVOTABLE = ['pivot_table_v2'];\n\nexport const MenuItemWithCheckboxContainer = styled.div`\n  ${({ theme }) => css`\n    display: flex;\n    align-items: center;\n\n    & svg {\n      width: ${theme.gridUnit * 3}px;\n      height: ${theme.gridUnit * 3}px;\n    }\n\n    & span[role='checkbox'] {\n      display: inline-flex;\n      margin-right: ${theme.gridUnit}px;\n    }\n  `}\n`;\n\nexport const MenuTrigger = styled(Button)`\n  ${({ theme }) => css`\n    width: ${theme.gridUnit * 8}px;\n    height: ${theme.gridUnit * 8}px;\n    padding: 0;\n    border: 1px solid ${theme.colors.primary.dark2};\n\n    &.ant-btn > span.anticon {\n      line-height: 0;\n      transition: inherit;\n    }\n\n    &:hover:not(:focus) > span.anticon {\n      color: ${theme.colors.primary.light1};\n    }\n  `}\n`;\n\nconst iconReset = css`\n  .ant-dropdown-menu-item > & > .anticon:first-child {\n    margin-right: 0;\n    vertical-align: 0;\n  }\n`;\n\nexport const useExploreAdditionalActionsMenu = (\n  latestQueryFormData,\n  canDownloadCSV,\n  slice,\n  onOpenInEditor,\n  onOpenPropertiesModal,\n  ownState,\n  dashboards,\n  ...rest\n) => {\n  const theme = useTheme();\n  const { addDangerToast, addSuccessToast } = useToasts();\n  const dispatch = useDispatch();\n  const [showReportSubMenu, setShowReportSubMenu] = useState(null);\n  const [isDropdownVisible, setIsDropdownVisible] = useState(false);\n  const chart = useSelector(\n    state => state.charts?.[getChartKey(state.explore)],\n  );\n\n  const { datasource } = latestQueryFormData;\n\n  const shareByEmail = useCallback(async () => {\n    try {\n      const subject = t('Superset Chart');\n      const url = await getChartPermalink(latestQueryFormData);\n      const body = encodeURIComponent(t('%s%s', 'Check out this chart: ', url));\n      window.location.href = `mailto:?Subject=${subject}%20&Body=${body}`;\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, latestQueryFormData]);\n\n  const exportCSV = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            ownState,\n            resultType: 'full',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportCSVPivoted = useCallback(\n    () =>\n      canDownloadCSV\n        ? exportChart({\n            formData: latestQueryFormData,\n            resultType: 'post_processed',\n            resultFormat: 'csv',\n          })\n        : null,\n    [canDownloadCSV, latestQueryFormData],\n  );\n\n  const exportJson = useCallback(\n    () =>\n      exportChart({\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'json',\n      }),\n    [latestQueryFormData],\n  );\n\n  const exportExcel = useCallback(\n    () =>\n      exportChart({\n        formData: latestQueryFormData,\n        resultType: 'results',\n        resultFormat: 'xlsx',\n      }),\n    [latestQueryFormData],\n  );\n\n  const copyLink = useCallback(async () => {\n    try {\n      if (!latestQueryFormData) {\n        throw new Error();\n      }\n      await copyTextToClipboard(() => getChartPermalink(latestQueryFormData));\n      addSuccessToast(t('Copied to clipboard!'));\n    } catch (error) {\n      addDangerToast(t('Sorry, something went wrong. Try again later.'));\n    }\n  }, [addDangerToast, addSuccessToast, latestQueryFormData]);\n\n  const handleMenuClick = useCallback(\n    ({ key, domEvent }) => {\n      switch (key) {\n        case MENU_KEYS.EDIT_PROPERTIES:\n          onOpenPropertiesModal();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV:\n          exportCSV();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_CSV_PIVOTED:\n          exportCSVPivoted();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_JSON:\n          exportJson();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.EXPORT_TO_XLSX:\n          exportExcel();\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.DOWNLOAD_AS_IMAGE:\n          downloadAsImage(\n            '.panel-body .chart-container',\n            // eslint-disable-next-line camelcase\n            slice?.slice_name ?? t('New chart'),\n            true,\n          )(domEvent);\n          setIsDropdownVisible(false);\n          dispatch(\n            logEvent(LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE, {\n              chartId: slice?.slice_id,\n              chartName: slice?.slice_name,\n            }),\n          );\n          break;\n        case MENU_KEYS.COPY_PERMALINK:\n          copyLink();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.EMBED_CODE:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.SHARE_BY_EMAIL:\n          shareByEmail();\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.VIEW_QUERY:\n          setIsDropdownVisible(false);\n          break;\n        case MENU_KEYS.RUN_IN_SQL_LAB:\n          onOpenInEditor(latestQueryFormData, domEvent.metaKey);\n          setIsDropdownVisible(false);\n          break;\n        default:\n          break;\n      }\n    },\n    [\n      copyLink,\n      exportCSV,\n      exportCSVPivoted,\n      exportJson,\n      latestQueryFormData,\n      onOpenInEditor,\n      onOpenPropertiesModal,\n      shareByEmail,\n      slice?.slice_name,\n    ],\n  );\n\n  const menu = useMemo(\n    () => (\n      <Menu onClick={handleMenuClick} selectable={false} {...rest}>\n        <>\n          {slice && (\n            <Menu.Item key={MENU_KEYS.EDIT_PROPERTIES}>\n              {t('Edit chart properties')}\n            </Menu.Item>\n          )}\n          <Menu.SubMenu\n            title={t('Dashboards added to')}\n            key={MENU_KEYS.DASHBOARDS_ADDED_TO}\n          >\n            <DashboardsSubMenu\n              chartId={slice?.slice_id}\n              dashboards={dashboards}\n            />\n          </Menu.SubMenu>\n          <Menu.Divider />\n        </>\n        <Menu.SubMenu title={t('Download')} key={MENU_KEYS.DOWNLOAD_SUBMENU}>\n          {VIZ_TYPES_PIVOTABLE.includes(latestQueryFormData.viz_type) ? (\n            <>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to original .CSV')}\n              </Menu.Item>\n              <Menu.Item\n                key={MENU_KEYS.EXPORT_TO_CSV_PIVOTED}\n                icon={<Icons.FileOutlined css={iconReset} />}\n                disabled={!canDownloadCSV}\n              >\n                {t('Export to pivoted .CSV')}\n              </Menu.Item>\n            </>\n          ) : (\n            <Menu.Item\n              key={MENU_KEYS.EXPORT_TO_CSV}\n              icon={<Icons.FileOutlined css={iconReset} />}\n              disabled={!canDownloadCSV}\n            >\n              {t('Export to .CSV')}\n            </Menu.Item>\n          )}\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_JSON}\n            icon={<Icons.FileOutlined css={iconReset} />}\n          >\n            {t('Export to .JSON')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.DOWNLOAD_AS_IMAGE}\n            icon={<Icons.FileImageOutlined css={iconReset} />}\n          >\n            {t('Download as image')}\n          </Menu.Item>\n          <Menu.Item\n            key={MENU_KEYS.EXPORT_TO_XLSX}\n            icon={<Icons.FileOutlined css={iconReset} />}\n          >\n            {t('Export to Excel')}\n          </Menu.Item>\n        </Menu.SubMenu>\n        <Menu.SubMenu title={t('Share')} key={MENU_KEYS.SHARE_SUBMENU}>\n          <Menu.Item key={MENU_KEYS.COPY_PERMALINK}>\n            {t('Copy permalink to clipboard')}\n          </Menu.Item>\n          <Menu.Item key={MENU_KEYS.SHARE_BY_EMAIL}>\n            {t('Share chart by email')}\n          </Menu.Item>\n          {isFeatureEnabled(FeatureFlag.EMBEDDABLE_CHARTS) ? (\n            <Menu.Item key={MENU_KEYS.EMBED_CODE}>\n              <ModalTrigger\n                triggerNode={\n                  <span data-test=\"embed-code-button\">{t('Embed code')}</span>\n                }\n                modalTitle={t('Embed code')}\n                modalBody={\n                  <EmbedCodeContent\n                    formData={latestQueryFormData}\n                    addDangerToast={addDangerToast}\n                  />\n                }\n                maxWidth={`${theme.gridUnit * 100}px`}\n                destroyOnClose\n                responsive\n              />\n            </Menu.Item>\n          ) : null}\n        </Menu.SubMenu>\n        <Menu.Divider />\n        {showReportSubMenu ? (\n          <>\n            <Menu.SubMenu title={t('Manage email report')}>\n              <HeaderReportDropDown\n                chart={chart}\n                setShowReportSubMenu={setShowReportSubMenu}\n                showReportSubMenu={showReportSubMenu}\n                setIsDropdownVisible={setIsDropdownVisible}\n                isDropdownVisible={isDropdownVisible}\n                useTextMenu\n              />\n            </Menu.SubMenu>\n            <Menu.Divider />\n          </>\n        ) : (\n          <Menu>\n            <HeaderReportDropDown\n              chart={chart}\n              setShowReportSubMenu={setShowReportSubMenu}\n              setIsDropdownVisible={setIsDropdownVisible}\n              isDropdownVisible={isDropdownVisible}\n              useTextMenu\n            />\n          </Menu>\n        )}\n        <Menu.Item key={MENU_KEYS.VIEW_QUERY}>\n          <ModalTrigger\n            triggerNode={\n              <span data-test=\"view-query-menu-item\">{t('View query')}</span>\n            }\n            modalTitle={t('View query')}\n            modalBody={\n              <ViewQueryModal latestQueryFormData={latestQueryFormData} />\n            }\n            draggable\n            resizable\n            responsive\n          />\n        </Menu.Item>\n        {datasource && (\n          <Menu.Item key={MENU_KEYS.RUN_IN_SQL_LAB}>\n            {t('Run in SQL Lab')}\n          </Menu.Item>\n        )}\n      </Menu>\n    ),\n    [\n      addDangerToast,\n      canDownloadCSV,\n      chart,\n      dashboards,\n      handleMenuClick,\n      isDropdownVisible,\n      latestQueryFormData,\n      showReportSubMenu,\n      slice,\n      theme.gridUnit,\n    ],\n  );\n  return [menu, isDropdownVisible, setIsDropdownVisible];\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode } from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Tooltip } from 'src/components/Tooltip';\n\nexport const MenuItemTooltip = ({\n  title,\n  color,\n}: {\n  title: ReactNode;\n  color?: string;\n}) => (\n  <Tooltip title={title} placement=\"top\">\n    <Icons.InfoCircleOutlined\n      data-test=\"tooltip-trigger\"\n      css={(theme: SupersetTheme) => css`\n        color: ${color || theme.colors.text.label};\n        margin-left: ${theme.gridUnit * 2}px;\n        &.anticon {\n          font-size: unset;\n          .anticon {\n            line-height: unset;\n            vertical-align: unset;\n          }\n        }\n      `}\n    />\n  </Tooltip>\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { BOOL_FALSE_DISPLAY, BOOL_TRUE_DISPLAY } from 'src/constants';\n\nexport interface BooleanCellProps {\n  value?: boolean;\n}\n\nfunction BooleanCell({ value }: BooleanCellProps) {\n  return <span>{value ? BOOL_TRUE_DISPLAY : BOOL_FALSE_DISPLAY}</span>;\n}\n\nexport default BooleanCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { css, SupersetTheme } from '@superset-ui/core';\nimport { NULL_DISPLAY } from 'src/constants';\n\nfunction NullCell() {\n  return (\n    <span\n      css={(theme: SupersetTheme) => css`\n        color: ${theme.colors.grayscale.light1};\n      `}\n    >\n      {NULL_DISPLAY}\n    </span>\n  );\n}\n\nexport default NullCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { getTimeFormatter, TimeFormats } from '@superset-ui/core';\nimport NullCell from '../NullCell';\n\nexport interface TimeCellProps {\n  format?: string;\n  value?: number | Date;\n}\n\nfunction TimeCell({\n  format = TimeFormats.DATABASE_DATETIME,\n  value,\n}: TimeCellProps) {\n  if (value) {\n    return <span>{getTimeFormatter(format).format(value)}</span>;\n  }\n  return <NullCell />;\n}\n\nexport default TimeCell;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { css, useTheme } from '@superset-ui/core';\nimport { Radio } from 'src/components/Radio';\nimport { Space } from 'src/components';\nimport Icons from 'src/components/Icons';\nimport Popover from 'src/components/Popover';\n\nexport interface HeaderWithRadioGroupProps {\n  headerTitle: string;\n  groupTitle: string;\n  groupOptions: { label: string; value: string | number }[];\n  value?: string | number;\n  onChange: (value: string) => void;\n}\n\nfunction HeaderWithRadioGroup(props: HeaderWithRadioGroupProps) {\n  const { headerTitle, groupTitle, groupOptions, value, onChange } = props;\n  const theme = useTheme();\n  const [popoverVisible, setPopoverVisible] = useState(false);\n\n  return (\n    <div\n      css={css`\n        display: flex;\n        align-items: center;\n      `}\n    >\n      <Popover\n        trigger=\"click\"\n        visible={popoverVisible}\n        content={\n          <div>\n            <div\n              css={css`\n                font-weight: ${theme.typography.weights.bold};\n                margin-bottom: ${theme.gridUnit}px;\n              `}\n            >\n              {groupTitle}\n            </div>\n            <Radio.Group\n              value={value}\n              onChange={e => {\n                onChange(e.target.value);\n                setPopoverVisible(false);\n              }}\n            >\n              <Space direction=\"vertical\">\n                {groupOptions.map(option => (\n                  <Radio key={option.value} value={option.value}>\n                    {option.label}\n                  </Radio>\n                ))}\n              </Space>\n            </Radio.Group>\n          </div>\n        }\n        placement=\"bottomLeft\"\n        arrowPointAtCenter\n      >\n        <Icons.SettingOutlined\n          iconSize=\"m\"\n          iconColor={theme.colors.grayscale.light1}\n          css={css`\n            margin-top: 3px; // we need exactly 3px to align the icon\n            margin-right: ${theme.gridUnit}px;\n          `}\n          onClick={() => setPopoverVisible(true)}\n        />\n      </Popover>\n      {headerTitle}\n    </div>\n  );\n}\n\nexport default HeaderWithRadioGroup;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useMemo } from 'react';\nimport { Tag } from 'antd';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  isAdhocColumn,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport RowCountLabel from 'src/explore/components/RowCountLabel';\nimport Icons from 'src/components/Icons';\n\nexport default function TableControls({\n  filters,\n  setFilters,\n  totalCount,\n  loading,\n  onReload,\n}: {\n  filters: BinaryQueryObjectFilterClause[];\n  setFilters: (filters: BinaryQueryObjectFilterClause[]) => void;\n  totalCount?: number;\n  loading: boolean;\n  onReload: () => void;\n}) {\n  const theme = useTheme();\n  const filterMap: Record<string, BinaryQueryObjectFilterClause> = useMemo(\n    () =>\n      Object.assign(\n        {},\n        ...filters.map(filter => ({\n          [isAdhocColumn(filter.col)\n            ? (filter.col.label as string)\n            : filter.col]: filter,\n        })),\n      ),\n    [filters],\n  );\n\n  const removeFilter = useCallback(\n    colName => {\n      const updatedFilterMap = { ...filterMap };\n      delete updatedFilterMap[colName];\n      setFilters([...Object.values(updatedFilterMap)]);\n    },\n    [filterMap, setFilters],\n  );\n\n  const filterTags = useMemo(\n    () =>\n      Object.entries(filterMap)\n        .map(([colName, { val, formattedVal }]) => ({\n          colName,\n          val: formattedVal ?? val,\n        }))\n        .sort((a, b) => a.colName.localeCompare(b.colName)),\n    [filterMap],\n  );\n\n  return (\n    <div\n      css={css`\n        display: flex;\n        justify-content: space-between;\n        padding: ${theme.gridUnit / 2}px 0;\n        margin-bottom: ${theme.gridUnit * 2}px;\n      `}\n    >\n      <div\n        css={css`\n          display: flex;\n          flex-wrap: wrap;\n          margin-bottom: -${theme.gridUnit * 4}px;\n        `}\n      >\n        {filterTags.map(({ colName, val }) => (\n          <Tag\n            closable\n            onClose={removeFilter.bind(null, colName)}\n            key={colName}\n            css={css`\n              height: ${theme.gridUnit * 6}px;\n              display: flex;\n              align-items: center;\n              padding: ${theme.gridUnit / 2}px ${theme.gridUnit * 2}px;\n              margin-right: ${theme.gridUnit * 4}px;\n              margin-bottom: ${theme.gridUnit * 4}px;\n              line-height: 1.2;\n            `}\n            data-test=\"filter-col\"\n          >\n            <span\n              css={css`\n                margin-right: ${theme.gridUnit}px;\n              `}\n            >\n              {colName}\n            </span>\n            <strong data-test=\"filter-val\">{val}</strong>\n          </Tag>\n        ))}\n      </div>\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n          height: min-content;\n        `}\n      >\n        <RowCountLabel loading={loading && !totalCount} rowcount={totalCount} />\n        <Icons.ReloadOutlined\n          iconColor={theme.colors.grayscale.light1}\n          iconSize=\"l\"\n          aria-label={t('Reload')}\n          role=\"button\"\n          onClick={onReload}\n        />\n      </div>\n    </div>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  ReactElement,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  ensureIsArray,\n  GenericDataType,\n  JsonObject,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport { useResizeDetector } from 'react-resize-detector';\nimport Loading from 'src/components/Loading';\nimport BooleanCell from 'src/components/Table/cell-renderers/BooleanCell';\nimport NullCell from 'src/components/Table/cell-renderers/NullCell';\nimport TimeCell from 'src/components/Table/cell-renderers/TimeCell';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport Table, { ColumnsType, TableSize } from 'src/components/Table';\nimport HeaderWithRadioGroup from 'src/components/Table/header-renderers/HeaderWithRadioGroup';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { useDatasetMetadataBar } from 'src/features/datasets/metadataBar/useDatasetMetadataBar';\nimport TableControls from './DrillDetailTableControls';\nimport { getDrillPayload } from './utils';\nimport { ResultsPage } from './types';\n\nconst PAGE_SIZE = 50;\n\ninterface DataType {\n  [key: string]: any;\n}\n\n// Must be outside of the main component due to problems in\n// react-resize-detector with conditional rendering\n// https://github.com/maslianok/react-resize-detector/issues/178\nfunction Resizable({ children }: { children: ReactElement }) {\n  const { ref, height } = useResizeDetector();\n  return (\n    <div ref={ref} css={{ flex: 1 }}>\n      {React.cloneElement(children, { height })}\n    </div>\n  );\n}\n\nenum TimeFormatting {\n  Original,\n  Formatted,\n}\n\nexport default function DrillDetailPane({\n  formData,\n  initialFilters,\n}: {\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n}) {\n  const theme = useTheme();\n  const [pageIndex, setPageIndex] = useState(0);\n  const lastPageIndex = useRef(pageIndex);\n  const [filters, setFilters] = useState(initialFilters);\n  const [isLoading, setIsLoading] = useState(false);\n  const [responseError, setResponseError] = useState('');\n  const [resultsPages, setResultsPages] = useState<Map<number, ResultsPage>>(\n    new Map(),\n  );\n  const [timeFormatting, setTimeFormatting] = useState({});\n\n  const SAMPLES_ROW_LIMIT = useSelector(\n    (state: { common: { conf: JsonObject } }) =>\n      state.common.conf.SAMPLES_ROW_LIMIT,\n  );\n\n  // Extract datasource ID/type from string ID\n  const [datasourceId, datasourceType] = useMemo(\n    () => formData.datasource.split('__'),\n    [formData.datasource],\n  );\n\n  const { metadataBar, status: metadataBarStatus } = useDatasetMetadataBar({\n    datasetId: datasourceId,\n  });\n  // Get page of results\n  const resultsPage = useMemo(() => {\n    const nextResultsPage = resultsPages.get(pageIndex);\n    if (nextResultsPage) {\n      lastPageIndex.current = pageIndex;\n      return nextResultsPage;\n    }\n\n    return resultsPages.get(lastPageIndex.current);\n  }, [pageIndex, resultsPages]);\n\n  const mappedColumns: ColumnsType<DataType> = useMemo(\n    () =>\n      resultsPage?.colNames.map((column, index) => ({\n        key: column,\n        dataIndex: column,\n        title:\n          resultsPage?.colTypes[index] === GenericDataType.TEMPORAL ? (\n            <HeaderWithRadioGroup\n              headerTitle={column}\n              groupTitle={t('Formatting')}\n              groupOptions={[\n                { label: t('Original value'), value: TimeFormatting.Original },\n                {\n                  label: t('Formatted value'),\n                  value: TimeFormatting.Formatted,\n                },\n              ]}\n              value={\n                timeFormatting[column] === TimeFormatting.Original\n                  ? TimeFormatting.Original\n                  : TimeFormatting.Formatted\n              }\n              onChange={value =>\n                setTimeFormatting(state => ({ ...state, [column]: value }))\n              }\n            />\n          ) : (\n            column\n          ),\n        render: value => {\n          if (value === true || value === false) {\n            return <BooleanCell value={value} />;\n          }\n          if (value === null) {\n            return <NullCell />;\n          }\n          if (\n            resultsPage?.colTypes[index] === GenericDataType.TEMPORAL &&\n            timeFormatting[column] !== TimeFormatting.Original &&\n            (typeof value === 'number' || value instanceof Date)\n          ) {\n            return <TimeCell value={value} />;\n          }\n          return String(value);\n        },\n        width: 150,\n      })) || [],\n    [resultsPage?.colNames, resultsPage?.colTypes, timeFormatting],\n  );\n\n  const data: DataType[] = useMemo(\n    () =>\n      resultsPage?.data.map((row, index) =>\n        resultsPage?.colNames.reduce(\n          (acc, curr) => ({ ...acc, [curr]: row[curr] }),\n          {\n            key: index,\n          },\n        ),\n      ) || [],\n    [resultsPage?.colNames, resultsPage?.data],\n  );\n\n  // Clear cache on reload button click\n  const handleReload = useCallback(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, []);\n\n  // Clear cache and reset page index if filters change\n  useEffect(() => {\n    setResponseError('');\n    setResultsPages(new Map());\n    setPageIndex(0);\n  }, [filters]);\n\n  // Update cache order if page in cache\n  useEffect(() => {\n    if (\n      resultsPages.has(pageIndex) &&\n      [...resultsPages.keys()].at(-1) !== pageIndex\n    ) {\n      const nextResultsPages = new Map(resultsPages);\n      nextResultsPages.delete(pageIndex);\n      setResultsPages(\n        nextResultsPages.set(\n          pageIndex,\n          resultsPages.get(pageIndex) as ResultsPage,\n        ),\n      );\n    }\n  }, [pageIndex, resultsPages]);\n\n  // Download page of results & trim cache if page not in cache\n  useEffect(() => {\n    if (!responseError && !isLoading && !resultsPages.has(pageIndex)) {\n      setIsLoading(true);\n      const jsonPayload = getDrillPayload(formData, filters) ?? {};\n      const cachePageLimit = Math.ceil(SAMPLES_ROW_LIMIT / PAGE_SIZE);\n      getDatasourceSamples(\n        datasourceType,\n        datasourceId,\n        false,\n        jsonPayload,\n        PAGE_SIZE,\n        pageIndex + 1,\n      )\n        .then(response => {\n          setResultsPages(\n            new Map([\n              ...[...resultsPages.entries()].slice(-cachePageLimit + 1),\n              [\n                pageIndex,\n                {\n                  total: response.total_count,\n                  data: response.data,\n                  colNames: ensureIsArray(response.colnames),\n                  colTypes: ensureIsArray(response.coltypes),\n                },\n              ],\n            ]),\n          );\n          setResponseError('');\n        })\n        .catch(error => {\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [\n    SAMPLES_ROW_LIMIT,\n    datasourceId,\n    datasourceType,\n    filters,\n    formData,\n    isLoading,\n    pageIndex,\n    responseError,\n    resultsPages,\n  ]);\n\n  const bootstrapping =\n    (!responseError && !resultsPages.size) ||\n    metadataBarStatus === ResourceStatus.LOADING;\n\n  let tableContent = null;\n  if (responseError) {\n    // Render error if page download failed\n    tableContent = (\n      <pre\n        css={css`\n          margin-top: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {responseError}\n      </pre>\n    );\n  } else if (bootstrapping) {\n    // Render loading if first page hasn't loaded\n    tableContent = <Loading />;\n  } else if (resultsPage?.total === 0) {\n    // Render empty state if no results are returned for page\n    const title = t('No rows were returned for this dataset');\n    tableContent = <EmptyStateMedium image=\"document.svg\" title={title} />;\n  } else {\n    // Render table if at least one page has successfully loaded\n    tableContent = (\n      <Resizable>\n        <Table\n          data={data}\n          columns={mappedColumns}\n          size={TableSize.SMALL}\n          defaultPageSize={PAGE_SIZE}\n          recordCount={resultsPage?.total}\n          usePagination\n          loading={isLoading}\n          onChange={pagination =>\n            setPageIndex(pagination.current ? pagination.current - 1 : 0)\n          }\n          resizable\n          virtualize\n          allowHTML\n        />\n      </Resizable>\n    );\n  }\n\n  return (\n    <>\n      {!bootstrapping && metadataBar}\n      {!bootstrapping && (\n        <TableControls\n          filters={filters}\n          setFilters={setFilters}\n          totalCount={resultsPage?.total}\n          loading={isLoading}\n          onReload={handleReload}\n        />\n      )}\n      {tableContent}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { omit } from 'lodash';\nimport {\n  ensureIsArray,\n  QueryFormData,\n  BinaryQueryObjectFilterClause,\n  buildQueryObject,\n} from '@superset-ui/core';\n\nexport function getDrillPayload(\n  queryFormData?: QueryFormData,\n  drillFilters?: BinaryQueryObjectFilterClause[],\n) {\n  if (!queryFormData) {\n    return undefined;\n  }\n  const queryObject = buildQueryObject(queryFormData);\n  const extras = omit(queryObject.extras, 'having');\n  const filters = [\n    ...ensureIsArray(queryObject.filters),\n    ...ensureIsArray(drillFilters).map(f => omit(f, 'formattedVal')),\n  ];\n  return {\n    granularity: queryObject.granularity,\n    time_range: queryObject.time_range,\n    filters,\n    extras,\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport {\n  BinaryQueryObjectFilterClause,\n  css,\n  QueryFormData,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Modal from 'src/components/Modal';\nimport Button from 'src/components/Button';\nimport { useSelector } from 'react-redux';\nimport { DashboardPageIdContext } from 'src/dashboard/containers/DashboardPage';\nimport { Slice } from 'src/types/Chart';\nimport DrillDetailPane from './DrillDetailPane';\n\ninterface ModalFooterProps {\n  exploreChart: () => void;\n  closeModal?: () => void;\n}\n\nconst ModalFooter = ({ exploreChart, closeModal }: ModalFooterProps) => (\n  <>\n    <Button buttonStyle=\"secondary\" buttonSize=\"small\" onClick={exploreChart}>\n      {t('Edit chart')}\n    </Button>\n    <Button\n      buttonStyle=\"primary\"\n      buttonSize=\"small\"\n      onClick={closeModal}\n      data-test=\"close-drilltodetail-modal\"\n    >\n      {t('Close')}\n    </Button>\n  </>\n);\n\ninterface DrillDetailModalProps {\n  chartId: number;\n  formData: QueryFormData;\n  initialFilters: BinaryQueryObjectFilterClause[];\n  showModal: boolean;\n  onHideModal: () => void;\n}\n\nexport default function DrillDetailModal({\n  chartId,\n  formData,\n  initialFilters,\n  showModal,\n  onHideModal,\n}: DrillDetailModalProps) {\n  const theme = useTheme();\n  const history = useHistory();\n  const dashboardPageId = useContext(DashboardPageIdContext);\n  const { slice_name: chartName } = useSelector(\n    (state: { sliceEntities: { slices: Record<number, Slice> } }) =>\n      state.sliceEntities.slices[chartId],\n  );\n\n  const exploreUrl = useMemo(\n    () => `/explore/?dashboard_page_id=${dashboardPageId}&slice_id=${chartId}`,\n    [chartId, dashboardPageId],\n  );\n\n  const exploreChart = useCallback(() => {\n    history.push(exploreUrl);\n  }, [exploreUrl, history]);\n\n  return (\n    <Modal\n      show={showModal}\n      onHide={onHideModal ?? (() => null)}\n      css={css`\n        .ant-modal-body {\n          display: flex;\n          flex-direction: column;\n        }\n      `}\n      title={t('Drill to detail: %s', chartName)}\n      footer={<ModalFooter exploreChart={exploreChart} />}\n      responsive\n      resizable\n      resizableConfig={{\n        minHeight: theme.gridUnit * 128,\n        minWidth: theme.gridUnit * 128,\n        defaultSize: {\n          width: 'auto',\n          height: '75vh',\n        },\n      }}\n      draggable\n      destroyOnClose\n      maskClosable={false}\n    >\n      <DrillDetailPane formData={formData} initialFilters={initialFilters} />\n    </Modal>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode, useCallback, useMemo, useState } from 'react';\nimport { isEmpty } from 'lodash';\nimport {\n  Behavior,\n  BinaryQueryObjectFilterClause,\n  css,\n  extractQueryFields,\n  getChartMetadataRegistry,\n  QueryFormData,\n  removeHTMLTags,\n  styled,\n  t,\n} from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport DrillDetailModal from './DrillDetailModal';\nimport { getSubmenuYOffset } from '../utils';\nimport { MenuItemTooltip } from '../DisabledMenuItemTooltip';\nimport { MenuItemWithTruncation } from '../MenuItemWithTruncation';\n\nconst DRILL_TO_DETAIL_TEXT = t('Drill to detail by');\n\nconst DisabledMenuItem = ({ children, ...props }: { children: ReactNode }) => (\n  <Menu.Item disabled {...props}>\n    <div\n      css={css`\n        white-space: normal;\n        max-width: 160px;\n      `}\n    >\n      {children}\n    </div>\n  </Menu.Item>\n);\n\nconst Filter = ({\n  children,\n  stripHTML = false,\n}: {\n  children: ReactNode;\n  stripHTML: boolean;\n}) => {\n  const content =\n    stripHTML && typeof children === 'string'\n      ? removeHTMLTags(children)\n      : children;\n  return <span>{content}</span>;\n};\n\nconst StyledFilter = styled(Filter)`\n  ${({ theme }) => `\n     font-weight: ${theme.typography.weights.bold};\n     color: ${theme.colors.primary.base};\n   `}\n`;\n\nexport type DrillDetailMenuItemsProps = {\n  chartId: number;\n  formData: QueryFormData;\n  filters?: BinaryQueryObjectFilterClause[];\n  isContextMenu?: boolean;\n  contextMenuY?: number;\n  onSelection?: () => void;\n  onClick?: (event: MouseEvent) => void;\n  submenuIndex?: number;\n};\n\nconst DrillDetailMenuItems = ({\n  chartId,\n  formData,\n  filters = [],\n  isContextMenu = false,\n  contextMenuY = 0,\n  onSelection = () => null,\n  onClick = () => null,\n  submenuIndex = 0,\n  ...props\n}: DrillDetailMenuItemsProps) => {\n  const [modalFilters, setFilters] = useState<BinaryQueryObjectFilterClause[]>(\n    [],\n  );\n\n  const [showModal, setShowModal] = useState(false);\n  const openModal = useCallback(\n    (filters, event) => {\n      onClick(event);\n      onSelection();\n      setFilters(filters);\n      setShowModal(true);\n    },\n    [onClick, onSelection],\n  );\n\n  const closeModal = useCallback(() => {\n    setShowModal(false);\n  }, []);\n\n  // Check for Behavior.DRILL_TO_DETAIL to tell if plugin handles the `contextmenu`\n  // event for dimensions.  If it doesn't, tell the user that drill to detail by\n  // dimension is not supported.  If it does, and the `contextmenu` handler didn't\n  // pass any filters, tell the user that they didn't select a dimension.\n  const handlesDimensionContextMenu = useMemo(\n    () =>\n      getChartMetadataRegistry()\n        .get(formData.viz_type)\n        ?.behaviors.find(behavior => behavior === Behavior.DRILL_TO_DETAIL),\n    [formData.viz_type],\n  );\n\n  // Check metrics to see if chart's current configuration lacks\n  // aggregations, in which case Drill to Detail should be disabled.\n  const noAggregations = useMemo(() => {\n    const { metrics } = extractQueryFields(formData);\n    return isEmpty(metrics);\n  }, [formData]);\n\n  let drillToDetailMenuItem;\n  if (handlesDimensionContextMenu && noAggregations) {\n    drillToDetailMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-no-aggregations\">\n        {t('Drill to detail')}\n        <MenuItemTooltip\n          title={t(\n            'Drill to detail is disabled because this chart does not group data by dimension value.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  } else {\n    drillToDetailMenuItem = (\n      <Menu.Item\n        {...props}\n        key=\"drill-detail-no-filters\"\n        onClick={openModal.bind(null, [])}\n      >\n        {t('Drill to detail')}\n      </Menu.Item>\n    );\n  }\n\n  let drillToDetailByMenuItem;\n  if (!handlesDimensionContextMenu) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-chart-not-supported\">\n        {DRILL_TO_DETAIL_TEXT}\n        <MenuItemTooltip\n          title={t(\n            'Drill to detail by value is not yet supported for this chart type.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  }\n\n  if (handlesDimensionContextMenu && noAggregations) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-no-aggregations\">\n        {DRILL_TO_DETAIL_TEXT}\n      </DisabledMenuItem>\n    );\n  }\n\n  // Ensure submenu doesn't appear offscreen\n  const submenuYOffset = useMemo(\n    () =>\n      getSubmenuYOffset(\n        contextMenuY,\n        filters.length > 1 ? filters.length + 1 : filters.length,\n        submenuIndex,\n      ),\n    [contextMenuY, filters.length, submenuIndex],\n  );\n\n  if (handlesDimensionContextMenu && !noAggregations && filters?.length) {\n    drillToDetailByMenuItem = (\n      <Menu.SubMenu\n        {...props}\n        popupOffset={[0, submenuYOffset]}\n        popupClassName=\"chart-context-submenu\"\n        title={DRILL_TO_DETAIL_TEXT}\n      >\n        <div data-test=\"drill-to-detail-by-submenu\">\n          {filters.map((filter, i) => (\n            <MenuItemWithTruncation\n              {...props}\n              tooltipText={`${DRILL_TO_DETAIL_TEXT} ${filter.formattedVal}`}\n              key={`drill-detail-filter-${i}`}\n              onClick={openModal.bind(null, [filter])}\n            >\n              {`${DRILL_TO_DETAIL_TEXT} `}\n              <StyledFilter stripHTML>{filter.formattedVal}</StyledFilter>\n            </MenuItemWithTruncation>\n          ))}\n          {filters.length > 1 && (\n            <Menu.Item\n              {...props}\n              key=\"drill-detail-filter-all\"\n              onClick={openModal.bind(null, filters)}\n            >\n              <div>\n                {`${DRILL_TO_DETAIL_TEXT} `}\n                <StyledFilter stripHTML={false}>{t('all')}</StyledFilter>\n              </div>\n            </Menu.Item>\n          )}\n        </div>\n      </Menu.SubMenu>\n    );\n  }\n\n  if (handlesDimensionContextMenu && !noAggregations && !filters?.length) {\n    drillToDetailByMenuItem = (\n      <DisabledMenuItem {...props} key=\"drill-detail-by-select-aggregation\">\n        {DRILL_TO_DETAIL_TEXT}\n        <MenuItemTooltip\n          title={t(\n            'Right-click on a dimension value to drill to detail by that value.',\n          )}\n        />\n      </DisabledMenuItem>\n    );\n  }\n\n  return (\n    <>\n      {drillToDetailMenuItem}\n      {isContextMenu && drillToDetailByMenuItem}\n      <DrillDetailModal\n        chartId={chartId}\n        formData={formData}\n        initialFilters={modalFilters}\n        showModal={showModal}\n        onHideModal={closeModal}\n      />\n    </>\n  );\n};\n\nexport default DrillDetailMenuItems;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport React, { ReactNode } from 'react';\nimport { css, truncationCSS, useCSSTextTruncation } from '@superset-ui/core';\nimport { Menu } from 'src/components/Menu';\nimport { Tooltip } from 'src/components/Tooltip';\nimport type { MenuProps } from 'antd/lib/menu';\n\nexport type MenuItemWithTruncationProps = {\n  tooltipText: ReactNode;\n  children: ReactNode;\n  onClick?: MenuProps['onClick'];\n};\n\nexport const MenuItemWithTruncation = ({\n  tooltipText,\n  children,\n  ...props\n}: MenuItemWithTruncationProps) => {\n  const [itemRef, itemIsTruncated] = useCSSTextTruncation<HTMLDivElement>();\n\n  return (\n    <Menu.Item\n      css={css`\n        display: flex;\n      `}\n      {...props}\n    >\n      <Tooltip title={itemIsTruncated ? tooltipText : null}>\n        <div\n          ref={itemRef}\n          css={css`\n            max-width: 100%;\n            ${truncationCSS};\n          `}\n        >\n          {children}\n        </div>\n      </Tooltip>\n    </Menu.Item>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nexport const MENU_ITEM_HEIGHT = 32;\nconst MENU_PADDING = 4;\nconst MENU_VERTICAL_SPACING = 32;\n\n/**\n * Calculates an adjusted Y-offset for a menu or submenu to prevent that\n * menu from appearing offscreen\n *\n * @param clientY The original Y-offset\n * @param itemsCount The number of menu items\n */\nexport const getMenuAdjustedY = (\n  clientY: number,\n  itemsCount: number,\n  maxItemsContainerHeight = Number.MAX_SAFE_INTEGER,\n  additionalItemsHeight = 0,\n) => {\n  // Viewport height\n  const vh = Math.max(\n    document.documentElement.clientHeight || 0,\n    window.innerHeight || 0,\n  );\n\n  const menuHeight =\n    Math.min(MENU_ITEM_HEIGHT * itemsCount, maxItemsContainerHeight) +\n    MENU_VERTICAL_SPACING +\n    additionalItemsHeight;\n  // Always show the context menu inside the viewport\n  return vh - clientY < menuHeight ? vh - menuHeight : clientY;\n};\n\nexport const getSubmenuYOffset = (\n  contextMenuY: number,\n  itemsCount: number,\n  submenuIndex = 0,\n  maxItemsContainerHeight = Number.MAX_SAFE_INTEGER,\n  additionalItemsHeight = 0,\n) => {\n  const submenuY =\n    contextMenuY +\n    MENU_PADDING +\n    MENU_ITEM_HEIGHT * submenuIndex +\n    MENU_PADDING;\n\n  return (\n    getMenuAdjustedY(\n      submenuY,\n      itemsCount,\n      maxItemsContainerHeight,\n      additionalItemsHeight,\n    ) - submenuY\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { RefObject } from 'react';\nimport { AntdDropdown } from 'src/components';\nimport { DropDownProps } from 'antd/lib/dropdown';\nimport { styled } from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\n\nconst MenuDots = styled.div`\n  width: ${({ theme }) => theme.gridUnit * 0.75}px;\n  height: ${({ theme }) => theme.gridUnit * 0.75}px;\n  border-radius: 50%;\n  background-color: ${({ theme }) => theme.colors.grayscale.light1};\n\n  font-weight: ${({ theme }) => theme.typography.weights.normal};\n  display: inline-flex;\n  position: relative;\n\n  &:hover {\n    background-color: ${({ theme }) => theme.colors.primary.base};\n\n    &::before,\n    &::after {\n      background-color: ${({ theme }) => theme.colors.primary.base};\n    }\n  }\n\n  &::before,\n  &::after {\n    position: absolute;\n    content: ' ';\n    width: ${({ theme }) => theme.gridUnit * 0.75}px;\n    height: ${({ theme }) => theme.gridUnit * 0.75}px;\n    border-radius: 50%;\n    background-color: ${({ theme }) => theme.colors.grayscale.light1};\n  }\n\n  &::before {\n    top: ${({ theme }) => theme.gridUnit}px;\n  }\n\n  &::after {\n    bottom: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst MenuDotsWrapper = styled.div`\n  display: flex;\n  align-items: center;\n  padding: ${({ theme }) => theme.gridUnit * 2}px;\n  padding-left: ${({ theme }) => theme.gridUnit}px;\n`;\n\nexport enum IconOrientation {\n  VERTICAL = 'vertical',\n  HORIZONTAL = 'horizontal',\n}\nexport interface DropdownProps extends DropDownProps {\n  overlay: React.ReactElement;\n  iconOrientation?: IconOrientation;\n}\n\nconst RenderIcon = (\n  iconOrientation: IconOrientation = IconOrientation.VERTICAL,\n) => {\n  const component =\n    iconOrientation === IconOrientation.HORIZONTAL ? (\n      <Icons.MoreHoriz iconSize=\"xl\" />\n    ) : (\n      <MenuDots />\n    );\n  return component;\n};\n\nexport const Dropdown = ({\n  overlay,\n  iconOrientation = IconOrientation.VERTICAL,\n  ...rest\n}: DropdownProps) => (\n  <AntdDropdown overlay={overlay} {...rest}>\n    <MenuDotsWrapper data-test=\"dropdown-trigger\">\n      {RenderIcon(iconOrientation)}\n    </MenuDotsWrapper>\n  </AntdDropdown>\n);\n\ninterface ExtendedDropDownProps extends DropDownProps {\n  ref?: RefObject<HTMLDivElement>;\n}\n\nexport const NoAnimationDropdown = (\n  props: ExtendedDropDownProps & { children?: React.ReactNode },\n) => <AntdDropdown overlayStyle={props.overlayStyle} {...props} />;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { DataRecordFilters } from '@superset-ui/core';\n\nexport default function getEffectiveExtraFilters(filters: DataRecordFilters) {\n  return Object.entries(filters)\n    .map(([column, values]) => ({\n      col: column,\n      op: Array.isArray(values) ? 'IN' : '==',\n      val: values,\n    }))\n    .filter(filter => filter.val !== null);\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  DataMaskStateWithId,\n  DataRecordFilters,\n  JsonObject,\n  PartialFilters,\n} from '@superset-ui/core';\nimport { ChartConfiguration, ChartQueryPayload } from 'src/dashboard/types';\nimport { getExtraFormData } from 'src/dashboard/components/nativeFilters/utils';\nimport { areObjectsEqual } from 'src/reduxUtils';\nimport getEffectiveExtraFilters from './getEffectiveExtraFilters';\nimport { getAllActiveFilters } from '../activeAllDashboardFilters';\n\n// We cache formData objects so that our connected container components don't always trigger\n// render cascades. we cannot leverage the reselect library because our cache size is >1\nconst cachedFiltersByChart = {};\nconst cachedFormdataByChart = {};\n\nexport interface GetFormDataWithExtraFiltersArguments {\n  chartConfiguration: ChartConfiguration;\n  chart: ChartQueryPayload;\n  filters: DataRecordFilters;\n  colorScheme?: string;\n  colorNamespace?: string;\n  sliceId: number;\n  dataMask: DataMaskStateWithId;\n  nativeFilters: PartialFilters;\n  extraControls: Record<string, string | boolean | null>;\n  labelColors?: Record<string, string>;\n  sharedLabelColors?: Record<string, string>;\n  allSliceIds: number[];\n}\n\n// this function merge chart's formData with dashboard filters value,\n// and generate a new formData which will be used in the new query.\n// filters param only contains those applicable to this chart.\nexport default function getFormDataWithExtraFilters({\n  chart,\n  filters,\n  nativeFilters,\n  chartConfiguration,\n  colorScheme,\n  colorNamespace,\n  sliceId,\n  dataMask,\n  extraControls,\n  labelColors,\n  sharedLabelColors,\n  allSliceIds,\n}: GetFormDataWithExtraFiltersArguments) {\n  // if dashboard metadata + filters have not changed, use cache if possible\n  const cachedFormData = cachedFormdataByChart[sliceId];\n  if (\n    cachedFiltersByChart[sliceId] === filters &&\n    areObjectsEqual(cachedFormData?.color_scheme, colorScheme, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.color_namespace, colorNamespace, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.label_colors, labelColors, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.shared_label_colors, sharedLabelColors, {\n      ignoreUndefined: true,\n    }) &&\n    !!cachedFormData &&\n    areObjectsEqual(cachedFormData?.dataMask, dataMask, {\n      ignoreUndefined: true,\n    }) &&\n    areObjectsEqual(cachedFormData?.extraControls, extraControls, {\n      ignoreUndefined: true,\n    })\n  ) {\n    return cachedFormData;\n  }\n\n  let extraData: { extra_form_data?: JsonObject } = {};\n  const activeFilters = getAllActiveFilters({\n    chartConfiguration,\n    dataMask,\n    nativeFilters,\n    allSliceIds,\n  });\n  const filterIdsAppliedOnChart = Object.entries(activeFilters)\n    .filter(([, { scope }]) => scope.includes(chart.id))\n    .map(([filterId]) => filterId);\n  if (filterIdsAppliedOnChart.length) {\n    extraData = {\n      extra_form_data: getExtraFormData(dataMask, filterIdsAppliedOnChart),\n    };\n  }\n\n  const formData = {\n    ...chart.form_data,\n    label_colors: labelColors,\n    shared_label_colors: sharedLabelColors,\n    ...(colorScheme && { color_scheme: colorScheme }),\n    extra_filters: getEffectiveExtraFilters(filters),\n    ...extraData,\n    ...extraControls,\n  };\n\n  cachedFiltersByChart[sliceId] = filters;\n  cachedFormdataByChart[sliceId] = { ...formData, dataMask, extraControls };\n\n  return formData;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useMemo } from 'react';\nimport { zip } from 'lodash';\nimport { css, GenericDataType, styled } from '@superset-ui/core';\nimport {\n  CopyToClipboardButton,\n  FilterInput,\n  RowCount,\n} from 'src/explore/components/DataTableControl';\nimport { applyFormattingToTabularData } from 'src/utils/common';\nimport { getTimeColumns } from 'src/explore/components/DataTableControl/utils';\nimport { TableControlsProps } from '../types';\n\nexport const TableControlsWrapper = styled.div`\n  ${({ theme }) => `\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: ${theme.gridUnit * 2}px;\n\n    span {\n      flex-shrink: 0;\n    }\n  `}\n`;\n\nexport const TableControls = ({\n  data,\n  datasourceId,\n  onInputChange,\n  columnNames,\n  columnTypes,\n  isLoading,\n}: TableControlsProps) => {\n  const originalTimeColumns = getTimeColumns(datasourceId);\n  const formattedTimeColumns = zip<string, GenericDataType>(\n    columnNames,\n    columnTypes,\n  )\n    .filter(\n      ([name, type]) =>\n        type === GenericDataType.TEMPORAL &&\n        name &&\n        !originalTimeColumns.includes(name),\n    )\n    .map(([colname]) => colname);\n  const formattedData = useMemo(\n    () => applyFormattingToTabularData(data, formattedTimeColumns),\n    [data, formattedTimeColumns],\n  );\n  return (\n    <TableControlsWrapper>\n      <FilterInput onChangeHandler={onInputChange} />\n      <div\n        css={css`\n          display: flex;\n          align-items: center;\n        `}\n      >\n        <RowCount data={data} loading={isLoading} />\n        <CopyToClipboardButton data={formattedData} columns={columnNames} />\n      </div>\n    </TableControlsWrapper>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState } from 'react';\nimport { t } from '@superset-ui/core';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { TableControls } from './DataTableControls';\nimport { SingleQueryResultPaneProp } from '../types';\n\nexport const SingleQueryResultPane = ({\n  data,\n  colnames,\n  coltypes,\n  datasourceId,\n  dataSize = 50,\n  isVisible,\n}: SingleQueryResultPaneProp) => {\n  const [filterText, setFilterText] = useState('');\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n    {}, // moreConfig\n    true, // allowHTML\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={false}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  Datasource,\n  GenericDataType,\n  JsonObject,\n  QueryFormData,\n} from '@superset-ui/core';\nimport { ExploreActions } from 'src/explore/actions/exploreActions';\nimport { ChartStatus } from 'src/explore/types';\n\nexport enum ResultTypes {\n  Results = 'results',\n  Samples = 'samples',\n}\n\nexport interface DataTablesPaneProps {\n  queryFormData: QueryFormData;\n  datasource: Datasource;\n  queryForce: boolean;\n  ownState?: JsonObject;\n  chartStatus: ChartStatus;\n  onCollapseChange: (isOpen: boolean) => void;\n  errorMessage?: JSX.Element;\n  actions: ExploreActions;\n}\n\nexport interface ResultsPaneProps {\n  isRequest: boolean;\n  queryFormData: QueryFormData;\n  queryForce: boolean;\n  ownState?: JsonObject;\n  errorMessage?: React.ReactElement;\n  actions?: ExploreActions;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n\nexport interface SamplesPaneProps {\n  isRequest: boolean;\n  datasource: Datasource;\n  queryForce: boolean;\n  actions?: ExploreActions;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n\nexport interface TableControlsProps {\n  data: Record<string, any>[];\n  // {datasource.id}__{datasource.type}, eg: 1__table\n  datasourceId: string;\n  onInputChange: (input: string) => void;\n  columnNames: string[];\n  columnTypes: GenericDataType[];\n  isLoading: boolean;\n}\n\nexport interface QueryResultInterface {\n  colnames: string[];\n  coltypes: GenericDataType[];\n  data: Record<string, any>[][];\n}\n\nexport interface SingleQueryResultPaneProp extends QueryResultInterface {\n  // {datasource.id}__{datasource.type}, eg: 1__table\n  datasourceId: string;\n  dataSize?: number;\n  // reload OriginalFormattedTimeColumns from localStorage when isVisible is true\n  isVisible: boolean;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect } from 'react';\nimport {\n  ensureIsArray,\n  styled,\n  t,\n  getChartMetadataRegistry,\n} from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { ResultsPaneProps, QueryResultInterface } from '../types';\nimport { SingleQueryResultPane } from './SingleQueryResultPane';\nimport { TableControls } from './DataTableControls';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakMap();\n\nexport const useResultsPane = ({\n  isRequest,\n  queryFormData,\n  queryForce,\n  ownState,\n  errorMessage,\n  actions,\n  isVisible,\n  dataSize = 50,\n}: ResultsPaneProps): React.ReactElement[] => {\n  const metadata = getChartMetadataRegistry().get(\n    queryFormData?.viz_type || queryFormData?.vizType,\n  );\n\n  const [resultResp, setResultResp] = useState<QueryResultInterface[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(true);\n  const [responseError, setResponseError] = useState<string>('');\n  const queryCount = metadata?.queryObjectCount ?? 1;\n\n  useEffect(() => {\n    // it's an invalid formData when gets a errorMessage\n    if (errorMessage) return;\n    if (isRequest && cache.has(queryFormData)) {\n      setResultResp(ensureIsArray(cache.get(queryFormData)));\n      setResponseError('');\n      if (queryForce && actions) {\n        actions.setForceQuery(false);\n      }\n      setIsLoading(false);\n    }\n    if (isRequest && !cache.has(queryFormData)) {\n      setIsLoading(true);\n      getChartDataRequest({\n        formData: queryFormData,\n        force: queryForce,\n        resultFormat: 'json',\n        resultType: 'results',\n        ownState,\n      })\n        .then(({ json }) => {\n          setResultResp(ensureIsArray(json.result));\n          setResponseError('');\n          cache.set(queryFormData, json.result);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(response => {\n          getClientErrorObject(response).then(({ error, message }) => {\n            setResponseError(error || message || t('Sorry, an error occurred'));\n          });\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [queryFormData, isRequest]);\n\n  useEffect(() => {\n    if (errorMessage) {\n      setIsLoading(false);\n    }\n  }, [errorMessage]);\n\n  if (isLoading) {\n    return Array(queryCount).fill(<Loading />);\n  }\n\n  if (errorMessage) {\n    const title = t('Run a query to display results');\n    return Array(queryCount).fill(\n      <EmptyStateMedium image=\"document.svg\" title={title} />,\n    );\n  }\n\n  if (responseError) {\n    const err = (\n      <>\n        <TableControls\n          data={[]}\n          columnNames={[]}\n          columnTypes={[]}\n          datasourceId={queryFormData.datasource}\n          onInputChange={() => {}}\n          isLoading={false}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n    return Array(queryCount).fill(err);\n  }\n\n  if (resultResp.length === 0) {\n    const title = t('No results were returned for this query');\n    return Array(queryCount).fill(\n      <EmptyStateMedium image=\"document.svg\" title={title} />,\n    );\n  }\n\n  return resultResp\n    .slice(0, queryCount)\n    .map((result, idx) => (\n      <SingleQueryResultPane\n        data={result.data}\n        colnames={result.colnames}\n        coltypes={result.coltypes}\n        dataSize={dataSize}\n        datasourceId={queryFormData.datasource}\n        key={idx}\n        isVisible={isVisible}\n      />\n    ));\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React from 'react';\nimport { t, styled } from '@superset-ui/core';\nimport Tabs from 'src/components/Tabs';\nimport { ResultTypes, ResultsPaneProps } from '../types';\nimport { useResultsPane } from './useResultsPane';\n\nconst Wrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n\n  .ant-tabs {\n    height: 100%;\n  }\n\n  .ant-tabs-content {\n    height: 100%;\n  }\n\n  .ant-tabs-tabpane {\n    display: flex;\n    flex-direction: column;\n  }\n\n  .table-condensed {\n    overflow: auto;\n  }\n`;\n\nexport const ResultsPaneOnDashboard = ({\n  isRequest,\n  queryFormData,\n  queryForce,\n  ownState,\n  errorMessage,\n  actions,\n  isVisible,\n  dataSize = 50,\n}: ResultsPaneProps) => {\n  const resultsPanes = useResultsPane({\n    errorMessage,\n    queryFormData,\n    queryForce,\n    ownState,\n    isRequest,\n    actions,\n    dataSize,\n    isVisible,\n  });\n\n  if (resultsPanes.length === 1) {\n    return <Wrapper>{resultsPanes[0]}</Wrapper>;\n  }\n\n  const panes = resultsPanes.map((pane, idx) => {\n    if (idx === 0) {\n      return (\n        <Tabs.TabPane tab={t('Results')} key={ResultTypes.Results}>\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n\n    return (\n      <Tabs.TabPane\n        tab={t('Results %s', idx + 1)}\n        key={`${ResultTypes.Results} ${idx + 1}`}\n      >\n        {pane}\n      </Tabs.TabPane>\n    );\n  });\n\n  return (\n    <Wrapper>\n      <Tabs fullWidth={false}>{panes}</Tabs>\n    </Wrapper>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { ensureIsArray, GenericDataType, styled, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { EmptyStateMedium } from 'src/components/EmptyState';\nimport TableView, { EmptyWrapperType } from 'src/components/TableView';\nimport {\n  useFilteredTableData,\n  useTableColumns,\n} from 'src/explore/components/DataTableControl';\nimport { getDatasourceSamples } from 'src/components/Chart/chartAction';\nimport { TableControls } from './DataTableControls';\nimport { SamplesPaneProps } from '../types';\n\nconst Error = styled.pre`\n  margin-top: ${({ theme }) => `${theme.gridUnit * 4}px`};\n`;\n\nconst cache = new WeakSet();\n\nexport const SamplesPane = ({\n  isRequest,\n  datasource,\n  queryForce,\n  actions,\n  dataSize = 50,\n  isVisible,\n}: SamplesPaneProps) => {\n  const [filterText, setFilterText] = useState('');\n  const [data, setData] = useState<Record<string, any>[][]>([]);\n  const [colnames, setColnames] = useState<string[]>([]);\n  const [coltypes, setColtypes] = useState<GenericDataType[]>([]);\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [responseError, setResponseError] = useState<string>('');\n  const datasourceId = useMemo(\n    () => `${datasource.id}__${datasource.type}`,\n    [datasource],\n  );\n\n  useEffect(() => {\n    if (isRequest && queryForce) {\n      cache.delete(datasource);\n    }\n\n    if (isRequest && !cache.has(datasource)) {\n      setIsLoading(true);\n      getDatasourceSamples(datasource.type, datasource.id, queryForce, {})\n        .then(response => {\n          setData(ensureIsArray(response.data));\n          setColnames(ensureIsArray(response.colnames));\n          setColtypes(ensureIsArray(response.coltypes));\n          setResponseError('');\n          cache.add(datasource);\n          if (queryForce && actions) {\n            actions.setForceQuery(false);\n          }\n        })\n        .catch(error => {\n          setData([]);\n          setColnames([]);\n          setColtypes([]);\n          setResponseError(`${error.name}: ${error.message}`);\n        })\n        .finally(() => {\n          setIsLoading(false);\n        });\n    }\n  }, [datasource, isRequest, queryForce]);\n\n  // this is to preserve the order of the columns, even if there are integer values,\n  // while also only grabbing the first column's keys\n  const columns = useTableColumns(\n    colnames,\n    coltypes,\n    data,\n    datasourceId,\n    isVisible,\n    {}, // moreConfig\n    true, // allowHTML\n  );\n  const filteredData = useFilteredTableData(filterText, data);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n\n  if (responseError) {\n    return (\n      <>\n        <TableControls\n          data={filteredData}\n          columnNames={colnames}\n          columnTypes={coltypes}\n          datasourceId={datasourceId}\n          onInputChange={input => setFilterText(input)}\n          isLoading={isLoading}\n        />\n        <Error>{responseError}</Error>\n      </>\n    );\n  }\n\n  if (data.length === 0) {\n    const title = t('No samples were returned for this dataset');\n    return <EmptyStateMedium image=\"document.svg\" title={title} />;\n  }\n\n  return (\n    <>\n      <TableControls\n        data={filteredData}\n        columnNames={colnames}\n        columnTypes={coltypes}\n        datasourceId={datasourceId}\n        onInputChange={input => setFilterText(input)}\n        isLoading={isLoading}\n      />\n      <TableView\n        columns={columns}\n        data={filteredData}\n        pageSize={dataSize}\n        noDataText={t('No results')}\n        emptyWrapperType={EmptyWrapperType.Small}\n        className=\"table-condensed\"\n        isPaginationSticky\n        showRowCount={false}\n        small\n      />\n    </>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n  MouseEvent,\n} from 'react';\nimport {\n  isFeatureEnabled,\n  FeatureFlag,\n  styled,\n  t,\n  useTheme,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport Tabs from 'src/components/Tabs';\nimport {\n  getItem,\n  setItem,\n  LocalStorageKeys,\n} from 'src/utils/localStorageHelpers';\nimport {\n  SamplesPane,\n  TableControlsWrapper,\n  useResultsPane,\n} from './components';\nimport { DataTablesPaneProps, ResultTypes } from './types';\n\nconst SouthPane = styled.div`\n  ${({ theme }) => `\n    position: relative;\n    background-color: ${theme.colors.grayscale.light5};\n    z-index: 5;\n    overflow: hidden;\n\n    .ant-tabs {\n      height: 100%;\n    }\n\n    .ant-tabs-content-holder {\n      height: 100%;\n    }\n\n    .ant-tabs-content {\n      height: 100%;\n    }\n\n    .ant-tabs-tabpane {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n\n      .table-condensed {\n        height: 100%;\n        overflow: auto;\n        margin-bottom: ${theme.gridUnit * 4}px;\n\n        .table {\n          margin-bottom: ${theme.gridUnit * 2}px;\n        }\n      }\n\n      .pagination-container > ul[role='navigation'] {\n        margin-top: 0;\n      }\n    }\n  `}\n`;\n\nexport const DataTablesPane = ({\n  queryFormData,\n  datasource,\n  queryForce,\n  onCollapseChange,\n  chartStatus,\n  ownState,\n  errorMessage,\n  actions,\n}: DataTablesPaneProps) => {\n  const theme = useTheme();\n  const [activeTabKey, setActiveTabKey] = useState<string>(ResultTypes.Results);\n  const [isRequest, setIsRequest] = useState<Record<ResultTypes, boolean>>({\n    results: false,\n    samples: false,\n  });\n  const [panelOpen, setPanelOpen] = useState(\n    isFeatureEnabled(FeatureFlag.DATAPANEL_CLOSED_BY_DEFAULT)\n      ? false\n      : getItem(LocalStorageKeys.is_datapanel_open, false),\n  );\n\n  useEffect(() => {\n    if (!isFeatureEnabled(FeatureFlag.DATAPANEL_CLOSED_BY_DEFAULT))\n      setItem(LocalStorageKeys.is_datapanel_open, panelOpen);\n  }, [panelOpen]);\n\n  useEffect(() => {\n    if (!panelOpen) {\n      setIsRequest({\n        results: false,\n        samples: false,\n      });\n    }\n\n    if (\n      panelOpen &&\n      activeTabKey.startsWith(ResultTypes.Results) &&\n      chartStatus &&\n      chartStatus !== 'loading'\n    ) {\n      setIsRequest({\n        results: true,\n        samples: false,\n      });\n    }\n\n    if (panelOpen && activeTabKey === ResultTypes.Samples) {\n      setIsRequest({\n        results: false,\n        samples: true,\n      });\n    }\n  }, [panelOpen, activeTabKey, chartStatus]);\n\n  const handleCollapseChange = useCallback(\n    (isOpen: boolean) => {\n      onCollapseChange(isOpen);\n      setPanelOpen(isOpen);\n    },\n    [onCollapseChange],\n  );\n\n  const handleTabClick = useCallback(\n    (tabKey: string, e: MouseEvent) => {\n      if (!panelOpen) {\n        handleCollapseChange(true);\n      } else if (tabKey === activeTabKey) {\n        e.preventDefault();\n        handleCollapseChange(false);\n      }\n      setActiveTabKey(tabKey);\n    },\n    [activeTabKey, handleCollapseChange, panelOpen],\n  );\n\n  const CollapseButton = useMemo(() => {\n    const caretIcon = panelOpen ? (\n      <Icons.CaretUp\n        iconColor={theme.colors.grayscale.base}\n        aria-label={t('Collapse data panel')}\n      />\n    ) : (\n      <Icons.CaretDown\n        iconColor={theme.colors.grayscale.base}\n        aria-label={t('Expand data panel')}\n      />\n    );\n    return (\n      <TableControlsWrapper>\n        {panelOpen ? (\n          <span\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleCollapseChange(false)}\n          >\n            {caretIcon}\n          </span>\n        ) : (\n          <span\n            role=\"button\"\n            tabIndex={0}\n            onClick={() => handleCollapseChange(true)}\n          >\n            {caretIcon}\n          </span>\n        )}\n      </TableControlsWrapper>\n    );\n  }, [handleCollapseChange, panelOpen, theme.colors.grayscale.base]);\n\n  const queryResultsPanes = useResultsPane({\n    errorMessage,\n    queryFormData,\n    queryForce,\n    ownState,\n    isRequest: isRequest.results,\n    actions,\n    isVisible: ResultTypes.Results === activeTabKey,\n  }).map((pane, idx) => {\n    if (idx === 0) {\n      return (\n        <Tabs.TabPane tab={t('Results')} key={ResultTypes.Results}>\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n    if (idx > 0) {\n      return (\n        <Tabs.TabPane\n          tab={t('Results %s', idx + 1)}\n          key={`${ResultTypes.Results} ${idx + 1}`}\n        >\n          {pane}\n        </Tabs.TabPane>\n      );\n    }\n    return null;\n  });\n\n  return (\n    <SouthPane data-test=\"some-purposeful-instance\">\n      <Tabs\n        fullWidth={false}\n        tabBarExtraContent={CollapseButton}\n        activeKey={panelOpen ? activeTabKey : ''}\n        onTabClick={handleTabClick}\n      >\n        {queryResultsPanes}\n        <Tabs.TabPane tab={t('Samples')} key={ResultTypes.Samples}>\n          <SamplesPane\n            datasource={datasource}\n            queryForce={queryForce}\n            isRequest={isRequest.samples}\n            actions={actions}\n            isVisible={ResultTypes.Samples === activeTabKey}\n          />\n        </Tabs.TabPane>\n      </Tabs>\n    </SouthPane>\n  );\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useState } from 'react';\nimport { styled, ensureIsArray, t } from '@superset-ui/core';\nimport Loading from 'src/components/Loading';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport { getChartDataRequest } from 'src/components/Chart/chartAction';\nimport ViewQuery from 'src/explore/components/controls/ViewQuery';\n\ninterface Props {\n  latestQueryFormData: object;\n}\n\ntype Result = {\n  query: string;\n  language: string;\n};\n\nconst ViewQueryModalContainer = styled.div`\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ViewQueryModal: React.FC<Props> = props => {\n  const [result, setResult] = useState<Result[]>([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const loadChartData = (resultType: string) => {\n    setIsLoading(true);\n    getChartDataRequest({\n      formData: props.latestQueryFormData,\n      resultFormat: 'json',\n      resultType,\n    })\n      .then(({ json }) => {\n        setResult(ensureIsArray(json.result));\n        setIsLoading(false);\n        setError(null);\n      })\n      .catch(response => {\n        getClientErrorObject(response).then(({ error, message }) => {\n          setError(\n            error ||\n              message ||\n              response.statusText ||\n              t('Sorry, An error occurred'),\n          );\n          setIsLoading(false);\n        });\n      });\n  };\n  useEffect(() => {\n    loadChartData('query');\n  }, [JSON.stringify(props.latestQueryFormData)]);\n\n  if (isLoading) {\n    return <Loading />;\n  }\n  if (error) {\n    return <pre>{error}</pre>;\n  }\n\n  return (\n    <ViewQueryModalContainer>\n      {result.map(item =>\n        item.query ? (\n          <ViewQuery sql={item.query} language={item.language || undefined} />\n        ) : null,\n      )}\n    </ViewQueryModalContainer>\n  );\n};\n\nexport default ViewQueryModal;\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { css, t, useTheme } from '@superset-ui/core';\nimport Alert from 'src/components/Alert';\nimport { Dataset } from 'src/components/Chart/types';\nimport MetadataBar from 'src/components/MetadataBar';\nimport {\n  ContentType,\n  MetadataType,\n} from 'src/components/MetadataBar/ContentType';\nimport { ResourceStatus } from 'src/hooks/apiResources/apiResources';\nimport { cachedSupersetGet } from 'src/utils/cachedSupersetGet';\n\nexport type UseDatasetMetadataBarProps =\n  | { datasetId?: undefined; dataset: Dataset }\n  | { datasetId: number | string; dataset?: undefined };\nexport const useDatasetMetadataBar = ({\n  dataset: datasetProps,\n  datasetId,\n}: UseDatasetMetadataBarProps) => {\n  const theme = useTheme();\n  const [result, setResult] = useState<Dataset>();\n  const [status, setStatus] = useState<ResourceStatus>(\n    datasetProps ? ResourceStatus.COMPLETE : ResourceStatus.LOADING,\n  );\n\n  useEffect(() => {\n    if (!datasetProps && datasetId) {\n      cachedSupersetGet({\n        endpoint: `/api/v1/dataset/${datasetId}`,\n      })\n        .then(({ json: { result } }) => {\n          setResult(result);\n          setStatus(ResourceStatus.COMPLETE);\n        })\n        .catch(() => {\n          setStatus(ResourceStatus.ERROR);\n        });\n    }\n  }, [datasetId, datasetProps]);\n\n  const metadataBar = useMemo(() => {\n    const items: ContentType[] = [];\n    const dataset = datasetProps || result;\n    if (dataset) {\n      const {\n        changed_on_humanized,\n        created_on_humanized,\n        description,\n        table_name,\n        changed_by,\n        created_by,\n        owners,\n      } = dataset;\n      const notAvailable = t('Not available');\n      const createdBy =\n        `${created_by?.first_name ?? ''} ${\n          created_by?.last_name ?? ''\n        }`.trim() || notAvailable;\n      const modifiedBy = changed_by\n        ? `${changed_by.first_name} ${changed_by.last_name}`\n        : notAvailable;\n      const formattedOwners =\n        owners?.length > 0\n          ? owners.map(owner => `${owner.first_name} ${owner.last_name}`)\n          : [notAvailable];\n      items.push({\n        type: MetadataType.TABLE,\n        title: table_name,\n      });\n      items.push({\n        type: MetadataType.LAST_MODIFIED,\n        value: changed_on_humanized,\n        modifiedBy,\n      });\n      items.push({\n        type: MetadataType.OWNER,\n        createdBy,\n        owners: formattedOwners,\n        createdOn: created_on_humanized,\n      });\n      if (description) {\n        items.push({\n          type: MetadataType.DESCRIPTION,\n          value: description,\n        });\n      }\n    }\n    return (\n      <div\n        css={css`\n          display: flex;\n          margin-bottom: ${theme.gridUnit * 4}px;\n        `}\n      >\n        {status === ResourceStatus.COMPLETE && (\n          <MetadataBar items={items} tooltipPlacement=\"bottom\" />\n        )}\n        {status === ResourceStatus.ERROR && (\n          <Alert\n            type=\"error\"\n            message={t('There was an error loading the dataset metadata')}\n          />\n        )}\n      </div>\n    );\n  }, [datasetProps, result, status, theme.gridUnit]);\n\n  return {\n    metadataBar,\n    status,\n  };\n};\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n/**\n * Types mirroring enums in `superset/reports/models.py`:\n */\nexport type ReportScheduleType = 'Alert' | 'Report';\nexport type ReportCreationMethod = 'charts' | 'dashboards' | 'alerts_reports';\n\nexport type ReportRecipientType = 'Email' | 'Slack';\n\nexport enum ReportType {\n  DASHBOARDS = 'dashboards',\n  CHARTS = 'charts',\n}\n\nexport enum NOTIFICATION_FORMATS {\n  TEXT = 'TEXT',\n  PNG = 'PNG',\n  CSV = 'CSV',\n}\nexport interface ReportObject {\n  id?: number;\n  active: boolean;\n  crontab: string;\n  dashboard?: number;\n  chart?: number;\n  description?: string;\n  log_retention: number;\n  name: string;\n  owners: number[];\n  recipients: [\n    { recipient_config_json: { target: string }; type: ReportRecipientType },\n  ];\n  report_format: string;\n  timezone: string;\n  type: ReportScheduleType;\n  validator_config_json: {} | null;\n  validator_type: string;\n  working_timeout: number;\n  creation_method: string;\n  force_screenshot: boolean;\n  custom_width?: number | null;\n  error?: string;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, {\n  useState,\n  useEffect,\n  useReducer,\n  useCallback,\n  useMemo,\n} from 'react';\nimport { t, SupersetTheme } from '@superset-ui/core';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\nimport {\n  addReport,\n  editReport,\n} from 'src/features/reports/ReportModal/actions';\nimport Alert from 'src/components/Alert';\nimport TimezoneSelector from 'src/components/TimezoneSelector';\nimport LabeledErrorBoundInput from 'src/components/Form/LabeledErrorBoundInput';\nimport Icons from 'src/components/Icons';\nimport { CronError } from 'src/components/CronPicker';\nimport { RadioChangeEvent } from 'src/components';\nimport { Input } from 'src/components/Input';\nimport withToasts from 'src/components/MessageToasts/withToasts';\nimport { ChartState } from 'src/explore/types';\nimport {\n  ReportCreationMethod,\n  ReportObject,\n  NOTIFICATION_FORMATS,\n} from 'src/features/reports/types';\nimport { reportSelector } from 'src/views/CRUD/hooks';\nimport {\n  TRANSLATIONS,\n  StyledInputContainer,\n} from 'src/features/alerts/AlertReportModal';\nimport { CreationMethod } from './HeaderReportDropdown';\nimport {\n  antDErrorAlertStyles,\n  CustomWidthHeaderStyle,\n  StyledModal,\n  StyledTopSection,\n  StyledBottomSection,\n  StyledIconWrapper,\n  StyledScheduleTitle,\n  StyledCronPicker,\n  StyledCronError,\n  noBottomMargin,\n  StyledFooterButton,\n  TimezoneHeaderStyle,\n  SectionHeaderStyle,\n  StyledMessageContentTitle,\n  StyledRadio,\n  StyledRadioGroup,\n} from './styles';\n\ninterface ReportProps {\n  onHide: () => {};\n  addDangerToast: (msg: string) => void;\n  show: boolean;\n  userId: number;\n  userEmail: string;\n  chart?: ChartState;\n  chartName?: string;\n  dashboardId?: number;\n  dashboardName?: string;\n  creationMethod: ReportCreationMethod;\n  props: any;\n}\n\nconst TEXT_BASED_VISUALIZATION_TYPES = [\n  'pivot_table_v2',\n  'table',\n  'paired_ttest',\n];\n\nconst INITIAL_STATE = {\n  crontab: '0 12 * * 1',\n};\n\ntype ReportObjectState = Partial<ReportObject> & {\n  error?: string;\n  /**\n   * Is submitting changes to the backend.\n   */\n  isSubmitting?: boolean;\n};\n\n// Same instance to be used in useEffects\nconst EMPTY_OBJECT = {};\n\nfunction ReportModal({\n  onHide,\n  show = false,\n  dashboardId,\n  chart,\n  userId,\n  userEmail,\n  creationMethod,\n  dashboardName,\n  chartName,\n}: ReportProps) {\n  const vizType = chart?.sliceFormData?.viz_type;\n  const isChart = !!chart;\n  const isTextBasedChart =\n    isChart && vizType && TEXT_BASED_VISUALIZATION_TYPES.includes(vizType);\n  const defaultNotificationFormat = isTextBasedChart\n    ? NOTIFICATION_FORMATS.TEXT\n    : NOTIFICATION_FORMATS.PNG;\n  const entityName = dashboardName || chartName;\n  const initialState: ReportObjectState = useMemo(\n    () => ({\n      ...INITIAL_STATE,\n      name: entityName\n        ? t('Weekly Report for %s', entityName)\n        : t('Weekly Report'),\n    }),\n    [entityName],\n  );\n\n  const reportReducer = useCallback(\n    (state: ReportObjectState | null, action: 'reset' | ReportObjectState) => {\n      if (action === 'reset') {\n        return initialState;\n      }\n      return {\n        ...state,\n        ...action,\n      };\n    },\n    [initialState],\n  );\n\n  const [currentReport, setCurrentReport] = useReducer(\n    reportReducer,\n    initialState,\n  );\n  const [cronError, setCronError] = useState<CronError>();\n\n  const dispatch = useDispatch();\n  // Report fetch logic\n  const report = useSelector<any, ReportObject>(state => {\n    const resourceType = dashboardId\n      ? CreationMethod.DASHBOARDS\n      : CreationMethod.CHARTS;\n    return (\n      reportSelector(state, resourceType, dashboardId || chart?.id) ||\n      EMPTY_OBJECT\n    );\n  });\n  const isEditMode = report && Object.keys(report).length;\n\n  useEffect(() => {\n    if (isEditMode) {\n      setCurrentReport(report);\n    } else {\n      setCurrentReport('reset');\n    }\n  }, [isEditMode, report]);\n\n  const onSave = async () => {\n    // Create new Report\n    const newReportValues: Partial<ReportObject> = {\n      type: 'Report',\n      active: true,\n      force_screenshot: false,\n      custom_width: currentReport.custom_width,\n      creation_method: creationMethod,\n      dashboard: dashboardId,\n      chart: chart?.id,\n      owners: [userId],\n      recipients: [\n        {\n          recipient_config_json: { target: userEmail },\n          type: 'Email',\n        },\n      ],\n      name: currentReport.name,\n      description: currentReport.description,\n      crontab: currentReport.crontab,\n      report_format: currentReport.report_format || defaultNotificationFormat,\n      timezone: currentReport.timezone,\n    };\n\n    setCurrentReport({ isSubmitting: true, error: undefined });\n    try {\n      if (isEditMode) {\n        await dispatch(\n          editReport(currentReport.id, newReportValues as ReportObject),\n        );\n      } else {\n        await dispatch(addReport(newReportValues as ReportObject));\n      }\n      onHide();\n    } catch (e) {\n      const { error } = await getClientErrorObject(e);\n      setCurrentReport({ error });\n    }\n    setCurrentReport({ isSubmitting: false });\n  };\n\n  const wrappedTitle = (\n    <StyledIconWrapper>\n      <Icons.Calendar />\n      <span className=\"text\">\n        {isEditMode ? t('Edit email report') : t('Schedule a new email report')}\n      </span>\n    </StyledIconWrapper>\n  );\n\n  const renderModalFooter = (\n    <>\n      <StyledFooterButton key=\"back\" onClick={onHide}>\n        {t('Cancel')}\n      </StyledFooterButton>\n      <StyledFooterButton\n        key=\"submit\"\n        buttonStyle=\"primary\"\n        onClick={onSave}\n        disabled={!currentReport.name}\n        loading={currentReport.isSubmitting}\n      >\n        {isEditMode ? t('Save') : t('Add')}\n      </StyledFooterButton>\n    </>\n  );\n\n  const renderMessageContentSection = (\n    <>\n      <StyledMessageContentTitle>\n        <h4>{t('Message content')}</h4>\n      </StyledMessageContentTitle>\n      <div className=\"inline-container\">\n        <StyledRadioGroup\n          onChange={(event: RadioChangeEvent) => {\n            setCurrentReport({ report_format: event.target.value });\n          }}\n          value={currentReport.report_format || defaultNotificationFormat}\n        >\n          {isTextBasedChart && (\n            <StyledRadio value={NOTIFICATION_FORMATS.TEXT}>\n              {t('Text embedded in email')}\n            </StyledRadio>\n          )}\n          <StyledRadio value={NOTIFICATION_FORMATS.PNG}>\n            {t('Image (PNG) embedded in email')}\n          </StyledRadio>\n          <StyledRadio value={NOTIFICATION_FORMATS.CSV}>\n            {t('Formatted CSV attached in email')}\n          </StyledRadio>\n        </StyledRadioGroup>\n      </div>\n    </>\n  );\n  const renderCustomWidthSection = (\n    <StyledInputContainer>\n      <div className=\"control-label\" css={CustomWidthHeaderStyle}>\n        {TRANSLATIONS.CUSTOM_SCREENSHOT_WIDTH_TEXT}\n      </div>\n      <div className=\"input-container\">\n        <Input\n          type=\"number\"\n          name=\"custom_width\"\n          value={currentReport?.custom_width || ''}\n          placeholder={TRANSLATIONS.CUSTOM_SCREENSHOT_WIDTH_PLACEHOLDER_TEXT}\n          onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n            setCurrentReport({\n              custom_width: parseInt(event.target.value, 10) || null,\n            });\n          }}\n        />\n      </div>\n    </StyledInputContainer>\n  );\n\n  return (\n    <StyledModal\n      show={show}\n      onHide={onHide}\n      title={wrappedTitle}\n      footer={renderModalFooter}\n      width=\"432\"\n      centered\n    >\n      <StyledTopSection>\n        <LabeledErrorBoundInput\n          id=\"name\"\n          name=\"name\"\n          value={currentReport.name || ''}\n          placeholder={initialState.name}\n          required\n          validationMethods={{\n            onChange: ({ target }: { target: HTMLInputElement }) =>\n              setCurrentReport({ name: target.value }),\n          }}\n          label={t('Report Name')}\n          data-test=\"report-name-test\"\n        />\n        <LabeledErrorBoundInput\n          id=\"description\"\n          name=\"description\"\n          value={currentReport?.description || ''}\n          validationMethods={{\n            onChange: ({ target }: { target: HTMLInputElement }) => {\n              setCurrentReport({ description: target.value });\n            },\n          }}\n          label={t('Description')}\n          placeholder={t(\n            'Include a description that will be sent with your report',\n          )}\n          css={noBottomMargin}\n          data-test=\"report-description-test\"\n        />\n      </StyledTopSection>\n\n      <StyledBottomSection>\n        <StyledScheduleTitle>\n          <h4 css={(theme: SupersetTheme) => SectionHeaderStyle(theme)}>\n            {t('Schedule')}\n          </h4>\n          <p>\n            {t('A screenshot of the dashboard will be sent to your email at')}\n          </p>\n        </StyledScheduleTitle>\n\n        <StyledCronPicker\n          clearButton={false}\n          value={currentReport.crontab || '0 12 * * 1'}\n          setValue={(newValue: string) => {\n            setCurrentReport({ crontab: newValue });\n          }}\n          onError={setCronError}\n        />\n        <StyledCronError>{cronError}</StyledCronError>\n        <div\n          className=\"control-label\"\n          css={(theme: SupersetTheme) => TimezoneHeaderStyle(theme)}\n        >\n          {t('Timezone')}\n        </div>\n        <TimezoneSelector\n          timezone={currentReport.timezone}\n          onTimezoneChange={value => {\n            setCurrentReport({ timezone: value });\n          }}\n        />\n        {isChart && renderMessageContentSection}\n        {(!isChart || !isTextBasedChart) && renderCustomWidthSection}\n      </StyledBottomSection>\n      {currentReport.error && (\n        <Alert\n          type=\"error\"\n          css={(theme: SupersetTheme) => antDErrorAlertStyles(theme)}\n          message={\n            isEditMode\n              ? t('Failed to update report')\n              : t('Failed to create report')\n          }\n          description={currentReport.error}\n        />\n      )}\n    </StyledModal>\n  );\n}\n\nexport default withToasts(ReportModal);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { isEmpty } from 'lodash';\nimport {\n  t,\n  SupersetTheme,\n  css,\n  styled,\n  useTheme,\n  FeatureFlag,\n  isFeatureEnabled,\n  getExtensionsRegistry,\n  usePrevious,\n} from '@superset-ui/core';\nimport Icons from 'src/components/Icons';\nimport { Switch } from 'src/components/Switch';\nimport { AlertObject } from 'src/features/alerts/types';\nimport { Menu } from 'src/components/Menu';\nimport Checkbox from 'src/components/Checkbox';\nimport { noOp } from 'src/utils/common';\nimport { NoAnimationDropdown } from 'src/components/Dropdown';\nimport DeleteModal from 'src/components/DeleteModal';\nimport ReportModal from 'src/features/reports/ReportModal';\nimport { ChartState } from 'src/explore/types';\nimport { UserWithPermissionsAndRoles } from 'src/types/bootstrapTypes';\nimport {\n  fetchUISpecificReport,\n  toggleActive,\n  deleteActiveReport,\n} from 'src/features/reports/ReportModal/actions';\nimport { reportSelector } from 'src/views/CRUD/hooks';\nimport { MenuItemWithCheckboxContainer } from 'src/explore/components/useExploreAdditionalActionsMenu/index';\n\nconst extensionsRegistry = getExtensionsRegistry();\n\nconst deleteColor = (theme: SupersetTheme) => css`\n  color: ${theme.colors.error.base};\n`;\n\nconst onMenuHover = (theme: SupersetTheme) => css`\n  & .ant-menu-item {\n    padding: 5px 12px;\n    margin-top: 0px;\n    margin-bottom: 4px;\n    :hover {\n      color: ${theme.colors.grayscale.dark1};\n    }\n  }\n  :hover {\n    background-color: ${theme.colors.secondary.light5};\n  }\n`;\n\nconst onMenuItemHover = (theme: SupersetTheme) => css`\n  &:hover {\n    color: ${theme.colors.grayscale.dark1};\n    background-color: ${theme.colors.secondary.light5};\n  }\n`;\n\nconst StyledDropdownItemWithIcon = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  > *:first-child {\n    margin-right: ${({ theme }) => theme.gridUnit}px;\n  }\n`;\n\nconst DropdownItemExtension = extensionsRegistry.get(\n  'report-modal.dropdown.item.icon',\n);\n\nexport enum CreationMethod {\n  CHARTS = 'charts',\n  DASHBOARDS = 'dashboards',\n}\nexport interface HeaderReportProps {\n  dashboardId?: number;\n  chart?: ChartState;\n  useTextMenu?: boolean;\n  setShowReportSubMenu?: (show: boolean) => void;\n  setIsDropdownVisible?: (visible: boolean) => void;\n  isDropdownVisible?: boolean;\n  showReportSubMenu?: boolean;\n}\n\n// Same instance to be used in useEffects\nconst EMPTY_OBJECT = {};\n\nexport default function HeaderReportDropDown({\n  dashboardId,\n  chart,\n  useTextMenu = false,\n  setShowReportSubMenu,\n  setIsDropdownVisible,\n  isDropdownVisible,\n  ...rest\n}: HeaderReportProps) {\n  const dispatch = useDispatch();\n  const report = useSelector<any, AlertObject>(state => {\n    const resourceType = dashboardId\n      ? CreationMethod.DASHBOARDS\n      : CreationMethod.CHARTS;\n    return (\n      reportSelector(state, resourceType, dashboardId || chart?.id) ||\n      EMPTY_OBJECT\n    );\n  });\n\n  const isReportActive: boolean = report?.active || false;\n  const user: UserWithPermissionsAndRoles = useSelector<\n    any,\n    UserWithPermissionsAndRoles\n  >(state => state.user);\n  const canAddReports = () => {\n    if (!isFeatureEnabled(FeatureFlag.ALERT_REPORTS)) {\n      return false;\n    }\n\n    if (!user?.userId) {\n      // this is in the case that there is an anonymous user.\n      return false;\n    }\n\n    // Cannot add reports if the resource is not saved\n    if (!(dashboardId || chart?.id)) {\n      return false;\n    }\n\n    const roles = Object.keys(user.roles || []);\n    const permissions = roles.map(key =>\n      user.roles[key].filter(\n        perms => perms[0] === 'menu_access' && perms[1] === 'Manage',\n      ),\n    );\n    return permissions.some(permission => permission.length > 0);\n  };\n\n  const [currentReportDeleting, setCurrentReportDeleting] =\n    useState<AlertObject | null>(null);\n  const theme = useTheme();\n  const prevDashboard = usePrevious(dashboardId);\n  const [showModal, setShowModal] = useState<boolean>(false);\n  const toggleActiveKey = async (data: AlertObject, checked: boolean) => {\n    if (data?.id) {\n      dispatch(toggleActive(data, checked));\n    }\n  };\n\n  const handleReportDelete = async (report: AlertObject) => {\n    await dispatch(deleteActiveReport(report));\n    setCurrentReportDeleting(null);\n  };\n\n  const shouldFetch =\n    canAddReports() &&\n    !!((dashboardId && prevDashboard !== dashboardId) || chart?.id);\n\n  useEffect(() => {\n    if (shouldFetch) {\n      dispatch(\n        fetchUISpecificReport({\n          userId: user.userId,\n          filterField: dashboardId ? 'dashboard_id' : 'chart_id',\n          creationMethod: dashboardId ? 'dashboards' : 'charts',\n          resourceId: dashboardId || chart?.id,\n        }),\n      );\n    }\n  }, []);\n\n  const showReportSubMenu = report && setShowReportSubMenu && canAddReports();\n\n  // @z-index-below-dashboard-header (100) - 1 = 99\n  const dropdownOverlayStyle = {\n    zIndex: 99,\n    animationDuration: '0s',\n  };\n\n  useEffect(() => {\n    if (showReportSubMenu) {\n      setShowReportSubMenu(true);\n    } else if (!report && setShowReportSubMenu) {\n      setShowReportSubMenu(false);\n    }\n  }, [report]);\n\n  const handleShowMenu = () => {\n    if (setIsDropdownVisible) {\n      setIsDropdownVisible(false);\n      setShowModal(true);\n    }\n  };\n\n  const handleDeleteMenuClick = () => {\n    if (setIsDropdownVisible) {\n      setIsDropdownVisible(false);\n      setCurrentReportDeleting(report);\n    }\n  };\n\n  const textMenu = () =>\n    isEmpty(report) ? (\n      <Menu selectable={false} {...rest} css={onMenuHover}>\n        <Menu.Item onClick={handleShowMenu}>\n          {DropdownItemExtension ? (\n            <StyledDropdownItemWithIcon>\n              <div>{t('Set up an email report')}</div>\n              <DropdownItemExtension />\n            </StyledDropdownItemWithIcon>\n          ) : (\n            t('Set up an email report')\n          )}\n        </Menu.Item>\n        <Menu.Divider />\n      </Menu>\n    ) : (\n      isDropdownVisible && (\n        <Menu selectable={false} css={{ border: 'none' }}>\n          <Menu.Item\n            css={onMenuItemHover}\n            onClick={() => toggleActiveKey(report, !isReportActive)}\n          >\n            <MenuItemWithCheckboxContainer>\n              <Checkbox checked={isReportActive} onChange={noOp} />\n              {t('Email reports active')}\n            </MenuItemWithCheckboxContainer>\n          </Menu.Item>\n          <Menu.Item css={onMenuItemHover} onClick={handleShowMenu}>\n            {t('Edit email report')}\n          </Menu.Item>\n          <Menu.Item css={onMenuItemHover} onClick={handleDeleteMenuClick}>\n            {t('Delete email report')}\n          </Menu.Item>\n        </Menu>\n      )\n    );\n  const menu = () => (\n    <Menu selectable={false} css={{ width: '200px' }}>\n      <Menu.Item>\n        {t('Email reports active')}\n        <Switch\n          data-test=\"toggle-active\"\n          checked={isReportActive}\n          onClick={(checked: boolean) => toggleActiveKey(report, checked)}\n          size=\"small\"\n          css={{ marginLeft: theme.gridUnit * 2 }}\n        />\n      </Menu.Item>\n      <Menu.Item onClick={() => setShowModal(true)}>\n        {t('Edit email report')}\n      </Menu.Item>\n      <Menu.Item\n        onClick={() => setCurrentReportDeleting(report)}\n        css={deleteColor}\n      >\n        {t('Delete email report')}\n      </Menu.Item>\n    </Menu>\n  );\n\n  const iconMenu = () =>\n    isEmpty(report) ? (\n      <span\n        role=\"button\"\n        title={t('Schedule email report')}\n        tabIndex={0}\n        className=\"action-button action-schedule-report\"\n        onClick={() => setShowModal(true)}\n      >\n        <Icons.Calendar />\n      </span>\n    ) : (\n      <>\n        <NoAnimationDropdown\n          overlay={menu()}\n          overlayStyle={dropdownOverlayStyle}\n          trigger={['click']}\n          getPopupContainer={(triggerNode: any) =>\n            triggerNode.closest('.action-button')\n          }\n        >\n          <span\n            role=\"button\"\n            className=\"action-button action-schedule-report\"\n            tabIndex={0}\n          >\n            <Icons.Calendar />\n          </span>\n        </NoAnimationDropdown>\n      </>\n    );\n\n  return (\n    <>\n      {canAddReports() && (\n        <>\n          <ReportModal\n            userId={user.userId}\n            show={showModal}\n            onHide={() => setShowModal(false)}\n            userEmail={user.email}\n            dashboardId={dashboardId}\n            chart={chart}\n            creationMethod={\n              dashboardId ? CreationMethod.DASHBOARDS : CreationMethod.CHARTS\n            }\n          />\n          {useTextMenu ? textMenu() : iconMenu()}\n          {currentReportDeleting && (\n            <DeleteModal\n              description={t(\n                'This action will permanently delete %s.',\n                currentReportDeleting?.name,\n              )}\n              onConfirm={() => {\n                if (currentReportDeleting) {\n                  handleReportDelete(currentReportDeleting);\n                }\n              }}\n              onHide={() => setCurrentReportDeleting(null)}\n              open\n              title={t('Delete Report?')}\n            />\n          )}\n        </>\n      )}\n    </>\n  );\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { useEffect, useState } from 'react';\nimport shortid from 'shortid';\nimport { BroadcastChannel } from 'broadcast-channel';\n\ninterface TabIdChannelMessage {\n  type: 'REQUESTING_TAB_ID' | 'TAB_ID_DENIED';\n  tabId: string;\n}\n\n// TODO: We are using broadcast-channel to support Safari.\n// The native BroadcastChannel API will be supported in Safari version 15.4.\n// After that, we should remove this dependency and use the native API.\nconst channel = new BroadcastChannel<TabIdChannelMessage>('tab_id_channel');\n\nexport function useTabId() {\n  const [tabId, setTabId] = useState<string>();\n\n  function isStorageAvailable() {\n    try {\n      return window.localStorage && window.sessionStorage;\n    } catch (error) {\n      return false;\n    }\n  }\n  useEffect(() => {\n    if (!isStorageAvailable()) {\n      if (!tabId) {\n        setTabId(shortid.generate());\n      }\n      return;\n    }\n\n    const updateTabId = () => {\n      let lastTabId;\n      try {\n        lastTabId = window.localStorage.getItem('last_tab_id');\n      } catch (error) {\n        // continue regardless of error\n      }\n      const newTabId = String(\n        lastTabId ? Number.parseInt(lastTabId, 10) + 1 : 1,\n      );\n      try {\n        window.sessionStorage.setItem('tab_id', newTabId);\n        window.localStorage.setItem('last_tab_id', newTabId);\n      } catch (error) {\n        // continue regardless of error\n      }\n      setTabId(newTabId);\n    };\n    let storedTabId;\n    try {\n      storedTabId = window.sessionStorage.getItem('tab_id');\n    } catch (error) {\n      // continue regardless of error\n    }\n    if (storedTabId) {\n      channel.postMessage({\n        type: 'REQUESTING_TAB_ID',\n        tabId: storedTabId,\n      });\n      setTabId(storedTabId);\n    } else {\n      updateTabId();\n    }\n\n    channel.onmessage = messageEvent => {\n      if (messageEvent.tabId === tabId) {\n        if (messageEvent.type === 'REQUESTING_TAB_ID') {\n          const message: TabIdChannelMessage = {\n            type: 'TAB_ID_DENIED',\n            tabId: messageEvent.tabId,\n          };\n          channel.postMessage(message);\n        } else if (messageEvent.type === 'TAB_ID_DENIED') {\n          updateTabId();\n        }\n      }\n    };\n  }, [tabId]);\n\n  return tabId;\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { SupersetClient } from '@superset-ui/core';\nimport { cacheWrapper } from './cacheWrapper';\n\nexport const supersetGetCache = new Map<string, any>();\n\nexport const cachedSupersetGet = cacheWrapper(\n  SupersetClient.get,\n  supersetGetCache,\n  ({ endpoint }) => endpoint || '',\n);\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport { SyntheticEvent } from 'react';\nimport domToImage from 'dom-to-image-more';\nimport kebabCase from 'lodash/kebabCase';\nimport { t, supersetTheme } from '@superset-ui/core';\nimport { addWarningToast } from 'src/components/MessageToasts/actions';\n\n/**\n * generate a consistent file stem from a description and date\n *\n * @param description title or description of content of file\n * @param date date when file was generated\n */\nconst generateFileStem = (description: string, date = new Date()) =>\n  `${kebabCase(description)}-${date.toISOString().replace(/[: ]/g, '-')}`;\n\n/**\n * Create an event handler for turning an element into an image\n *\n * @param selector css selector of the parent element which should be turned into image\n * @param description name or a short description of what is being printed.\n *   Value will be normalized, and a date as well as a file extension will be added.\n * @param isExactSelector if false, searches for the closest ancestor that matches selector.\n * @returns event handler\n */\nexport default function downloadAsImage(\n  selector: string,\n  description: string,\n  isExactSelector = false,\n) {\n  return (event: SyntheticEvent) => {\n    const elementToPrint = isExactSelector\n      ? document.querySelector(selector)\n      : event.currentTarget.closest(selector);\n\n    if (!elementToPrint) {\n      return addWarningToast(\n        t('Image download failed, please refresh and try again.'),\n      );\n    }\n\n    // Mapbox controls are loaded from different origin, causing CORS error\n    // See https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL#exceptions\n    const filter = (node: Element) => {\n      if (typeof node.className === 'string') {\n        return (\n          node.className !== 'mapboxgl-control-container' &&\n          !node.className.includes('header-controls')\n        );\n      }\n      return true;\n    };\n\n    return domToImage\n      .toJpeg(elementToPrint, {\n        bgcolor: supersetTheme.colors.grayscale.light4,\n        filter,\n      })\n      .then((dataUrl: string) => {\n        const link = document.createElement('a');\n        link.download = `${generateFileStem(description)}.jpg`;\n        link.href = dataUrl;\n        link.click();\n      })\n      .catch((e: Error) => {\n        console.error('Creating image failed', e);\n      });\n  };\n}\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\nimport { t } from '@superset-ui/core';\n\nconst CREATE_CHART_TEXT = t('Create chart');\nconst UPDATE_CHART_TEXT = t('Update chart');\n\nexport const getChartRequiredFieldsMissingMessage = (isCreating: boolean) =>\n  t(\n    'Select values in highlighted field(s) in the control panel. Then run the query by clicking on the %s button.',\n    `\"${isCreating ? CREATE_CHART_TEXT : UPDATE_CHART_TEXT}\"`,\n  );\n","/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nimport {\n  AdhocFilter,\n  isAdhocColumn,\n  QueryObjectFilterClause,\n  SimpleAdhocFilter,\n} from '@superset-ui/core';\nimport {\n  CLAUSES,\n  EXPRESSION_TYPES,\n} from '../explore/components/controls/FilterControl/types';\nimport { OPERATOR_ENUM_TO_OPERATOR_TYPE } from '../explore/constants';\nimport { translateToSql } from '../explore/components/controls/FilterControl/utils/translateToSQL';\n\nexport const simpleFilterToAdhoc = (\n  filterClause: QueryObjectFilterClause,\n  clause: CLAUSES = CLAUSES.WHERE,\n) => {\n  let result: AdhocFilter;\n  if (isAdhocColumn(filterClause.col)) {\n    result = {\n      expressionType: 'SQL',\n      clause,\n      sqlExpression: translateToSql({\n        expressionType: EXPRESSION_TYPES.SIMPLE,\n        subject: `(${filterClause.col.sqlExpression})`,\n        operator: filterClause.op,\n        comparator: 'val' in filterClause ? filterClause.val : undefined,\n      } as SimpleAdhocFilter),\n    };\n  } else {\n    result = {\n      expressionType: 'SIMPLE',\n      clause,\n      operator: filterClause.op,\n      operatorId: Object.entries(OPERATOR_ENUM_TO_OPERATOR_TYPE).find(\n        operatorEntry => operatorEntry[1].operation === filterClause.op,\n      )?.[0],\n      subject: filterClause.col,\n      comparator: 'val' in filterClause ? filterClause.val : undefined,\n    } as SimpleAdhocFilter;\n  }\n  if (filterClause.isExtra) {\n    Object.assign(result, {\n      isExtra: true,\n      filterOptionName: `filter_${Math.random()\n        .toString(36)\n        .substring(2, 15)}_${Math.random().toString(36).substring(2, 15)}`,\n    });\n  }\n  return result;\n};\n"],"names":["ChartSource","DrillByType","DrillByChart","_ref","formData","result","dataset","onContextMenu","inContextMenu","hooks","useMemo","___EmotionJSX","css","SuperChart","disableErrorBoundary","chartType","viz_type","enableNoResults","datasource","queriesData","height","width","BreadcrumbItem","styled","AntdBreadcrumb","Item","theme","isClickable","colors","grayscale","light1","transitionTiming","dark1","PaginationContainer","div","gridUnit","DEFAULT_ADHOC_FILTER_FIELD_NAME","ModalFooter","closeModal","dispatch","useDispatch","addDangerToast","useToasts","url","setUrl","useState","dashboardPageId","useContext","DashboardPageIdContext","onEditChartClick","useCallback","logEvent","LOG_ACTIONS_DRILL_BY_EDIT_CHART","slice_id","datasource_id","datasource_type","split","useEffect","postFormData","Number","then","key","catch","t","React","Button","buttonStyle","buttonSize","onClick","disabled","Link","to","DrillByModal","_ref2","column","drillByConfig","onHideModal","useTheme","isChartDataLoading","setIsChartDataLoading","drillByConfigs","setDrillByConfigs","LOG_ACTIONS_DRILL_BY_MODAL_OPENED","currentColumn","groupbyFieldName","length","initialGroupbyColumns","ensureIsArray","map","colName","_dataset$columns","columns","find","col","column_name","filter","isDefined","displayModeToggle","drillByDisplayMode","useDisplayModeToggle","setDrillByDisplayMode","Chart","Radio","Group","onChange","target","value","defaultValue","Table","chartDataResult","setChartDataResult","resultsTable","useResultsTableView","datasourceId","SingleQueryResultPane","colnames","coltypes","data","dataSize","isVisible","Tabs","fullWidth","res","index","TabPane","tab","currentFormData","setCurrentFormData","usedGroupbyColumns","setUsedGroupbyColumns","breadcrumbsData","setBreadcrumbsData","groupby","filters","getNewGroupby","groupbyCol","fieldName","Array","isArray","getFormDataChangesFromConfigs","configs","reduce","acc","config","overridenGroupbyFields","add","adhocFilterFieldName","simpleFilterToAdhoc","overridenAdhocFilterFields","Set","getFiltersFromConfigsByFieldName","breadcrumbs","onBreadcrumbClick","noOp","breadcrumb","getBreadcrumbText","verbose_name","join","formattedVal","val","useDrillByBreadcrumbs","LOG_ACTIONS_DRILL_BY_BREADCRUMB_CLICKED","prevConfigs","slice","prevBreadcrumbs","newBreadcrumbs","prevUsedGroupbyColumns","overrideFormData","newFormData","forEach","adhocFilterField","drilledFormData","updatedFormData","adhocFilters","Object","keys","slice_name","dashboards","usedCols","some","usedCol","onSelection","newColumn","LOG_ACTIONS_FURTHER_DRILL_BY","drill_depth","additionalConfig","drillBy","excludedColumns","openNewModal","contextMenu","useContextMenu","chartId","displayedItems","contextMenuRef","useRef","setInContextMenu","handleContextMenuSelected","_len","arguments","args","_key","handleContextMenuClosed","ChartContextMenu","ref","id","onClose","offsetX","offsetY","_contextMenuRef$curre","current","open","ContextMenuItem","DrillBy","chartName","useSelector","state","chartLayoutItem","values","dashboardLayout","present","layoutItem","_layoutItem$meta","meta","sliceNameOverride","sliceName","useLegacyApi","getQuerySettings","undefined","getChartDataRequest","_ref3","response","json","handleChartDataResponse","queriesResponse","finally","metadataBar","useDatasetMetadataBar","Modal","show","onHide","title","footer","responsive","resizable","resizableConfig","minHeight","minWidth","defaultSize","draggable","destroyOnClose","maskClosable","Loading","Alert","type","message","DrillByMenuItems","contextMenuY","submenuIndex","rest","isLoadingColumns","setIsLoadingColumns","searchInput","setSearchInput","setDataset","setColumns","showModal","setShowModal","setCurrentColumn","handleSelection","event","hasDrillBy","handlesDimensionContextMenu","_getChartMetadataRegi","getChartMetadataRegistry","get","behaviors","behavior","Behavior","DRILL_BY","verboseMap","useVerboseMap","verbose_map","metrics","metric","metric_name","datasetId","cachedSupersetGet","endpoint","_drillByConfig$groupb","_ensureIsArray","includes","x_axis","every","excludedCol","supersetGetCache","delete","handleInput","e","_e$target","stopPropagation","input","filteredColumns","toLowerCase","submenuYOffset","getSubmenuYOffset","tooltip","Menu","SubMenu","_extends","popupClassName","popupOffset","Input","prefix","Icons","Search","iconSize","iconColor","placeholder","nativeEvent","stopImmediatePropagation","allowClear","position","MenuItemWithTruncation","tooltipText","MenuItemTooltip","_getChartMetadataRegi2","All","canExplore","_state$user","findPermission","user","roles","crossFiltersEnabled","dashboardInfo","isDisplayed","item","clientX","clientY","setState","menuItems","showDrillToDetail","isFeatureEnabled","FeatureFlag","DRILL_TO_DETAIL","DrillToDetail","showDrillBy","showCrossFilters","DASHBOARD_CROSS_FILTERS","CrossFilter","isCrossFilteringSupportedByChart","INTERACTIVE_CHART","itemsCount","_filters$crossFilter","isCrossFilterDisabled","crossFilter","crossFilteringTooltipTitle","push","updateDataMask","dataMask","isCurrentValueSelected","color","base","Divider","DrillDetailMenuItems","drillToDetail","isContextMenu","_document$getElementB","adjustedY","getMenuAdjustedY","document","getElementById","click","useImperativeHandle","ReactDOM","Dropdown","overlay","className","trigger","onVisibleChange","_css","visibility","top","left","body","forwardRef","propTypes","annotationData","PropTypes","actions","isRequired","initialValues","latestQueryFormData","labelColors","sharedLabelColors","setControlValue","vizType","triggerRender","chartAlert","chartStatus","triggerQuery","chartIsStale","addFilter","setDataMask","onFilterMenuOpen","onFilterMenuClose","ownState","postTransformProps","source","Dashboard","Explore","emitCrossFilters","BLANK","defaultProps","ChartRenderer","constructor","props","super","this","showContextMenu","legendState","hasQueryResponseChange","handleAddFilter","bind","handleRenderSuccess","handleRenderFailure","handleSetControlValue","handleOnContextMenu","handleLegendStateChanged","onContextMenuFallback","onAddFilter","onError","onLegendStateChanged","_this$props$actions","mutableQueriesResponse","_cloneDeep","shouldComponentUpdate","nextProps","nextState","_nextProps$queriesRes","_nextProps$queriesRes2","indexOf","error","_isEqual","filterState","color_scheme","stack","cacheBusterProp","vals","merge","refresh","chartRenderingSucceeded","LOG_ACTIONS_RENDER_CHART","start_offset","renderStartTime","ts","Date","getTime","duration","Logger","getTimestamp","info","logging","warn","chartRenderingFailed","toString","componentStack","has_err","error_details","preventDefault","render","snakeCaseVizType","_snakeCase","chartClassName","noResultsComponent","noResultTitle","noResultDescription","noResultImage","EmptyStateBig","description","image","EmptyStateSmall","drillToDetailProps","onRenderSuccess","onRenderFailure","noResults","ChartErrorMessage","owners","useChartOwnerNames","ownedError","extra","ErrorMessageWithStackTrace","dashboardId","timeout","force","isFiltersInitialized","chartStackTrace","errorMessage","onQuery","datasetsStatus","isInView","NONEXISTENT_DATASET","Styles","p","typography","sizes","s","MonospaceDiv","families","monospace","handleRenderContainerFailure","componentDidMount","runQuery","componentDidUpdate","CLIENT_CACHE","getSavedChart","getUrlParam","URL_PARAMS","postChartFormData","Boolean","renderErrorMessage","queryResponse","_queryResponse$errors","errors","PLACEHOLDER_DATASOURCE","ResourceStatus","ERROR","subtitle","copyText","link","stackTrace","isLoading","renderContainerStartTime","getChartRequiredFieldsMissingMessage","ErrorBoundary","showMessage","DASHBOARD_VIRTUALIZATION","isCurrentUserBot","role","tabIndex","connect","bindActionCreators","CopyButtonEmbedCode","CopyButton","setHeight","setWidth","setErrorMessage","handleInputChange","name","currentTarget","updateUrl","getChartPermalink","html","srcLink","standalone","text","CopyToClipboard","shouldShowText","copyNode","TextArea","rows","readOnly","secondary","light5","htmlFor","menuProps","dashboardSearch","setDashboardSearch","hoveredItem","setHoveredItem","showSearch","filteredDashboards","dashboard","dashboard_title","noResultsFound","urlQueryString","String","onMouseEnter","onMouseLeave","rel","Full","MENU_KEYS","VIZ_TYPES_PIVOTABLE","MenuItemWithCheckboxContainer","iconReset","primary","dark2","useExploreAdditionalActionsMenu","canDownloadCSV","onOpenInEditor","onOpenPropertiesModal","addSuccessToast","showReportSubMenu","setShowReportSubMenu","isDropdownVisible","setIsDropdownVisible","chart","_state$charts","charts","getChartKey","explore","shareByEmail","async","subject","encodeURIComponent","window","location","href","exportCSV","exportChart","resultType","resultFormat","exportCSVPivoted","exportJson","exportExcel","copyLink","Error","copyTextToClipboard","handleMenuClick","_slice$slice_name","domEvent","LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV","LOG_ACTIONS_CHART_DOWNLOAD_AS_CSV_PIVOTED","LOG_ACTIONS_CHART_DOWNLOAD_AS_JSON","LOG_ACTIONS_CHART_DOWNLOAD_AS_XLS","downloadAsImage","LOG_ACTIONS_CHART_DOWNLOAD_AS_IMAGE","metaKey","selectable","DashboardsSubMenu","icon","FileOutlined","FileImageOutlined","EMBEDDABLE_CHARTS","ModalTrigger","triggerNode","modalTitle","modalBody","EmbedCodeContent","maxWidth","HeaderReportDropDown","useTextMenu","ViewQueryModal","Tooltip","placement","InfoCircleOutlined","label","BOOL_TRUE_DISPLAY","BOOL_FALSE_DISPLAY","NULL_DISPLAY","format","TimeFormats","DATABASE_DATETIME","getTimeFormatter","NullCell","headerTitle","groupTitle","groupOptions","popoverVisible","setPopoverVisible","Popover","visible","content","weights","bold","Space","direction","option","arrowPointAtCenter","SettingOutlined","TableControls","setFilters","totalCount","loading","onReload","filterMap","assign","isAdhocColumn","removeFilter","updatedFilterMap","filterTags","entries","sort","a","b","localeCompare","Tag","closable","RowCountLabel","rowcount","ReloadOutlined","PAGE_SIZE","TimeFormatting","styles","Resizable","children","useResizeDetector","DrillDetailPane","initialFilters","pageIndex","setPageIndex","lastPageIndex","setIsLoading","responseError","setResponseError","resultsPages","setResultsPages","Map","timeFormatting","setTimeFormatting","SAMPLES_ROW_LIMIT","common","conf","datasourceType","status","metadataBarStatus","resultsPage","nextResultsPage","mappedColumns","colNames","dataIndex","colTypes","GenericDataType","TEMPORAL","HeaderWithRadioGroup","Original","Formatted","BooleanCell","TimeCell","row","curr","handleReload","has","at","nextResultsPages","set","_getDrillPayload","jsonPayload","queryFormData","drillFilters","queryObject","buildQueryObject","extras","_omit","f","granularity","time_range","getDrillPayload","cachePageLimit","Math","ceil","getDatasourceSamples","total","total_count","bootstrapping","size","LOADING","tableContent","EmptyStateMedium","TableSize","SMALL","defaultPageSize","recordCount","usePagination","pagination","virtualize","allowHTML","exploreChart","DrillDetailModal","history","useHistory","sliceEntities","slices","exploreUrl","DRILL_TO_DETAIL_TEXT","DisabledMenuItem","StyledFilter","stripHTML","removeHTMLTags","_ref4","modalFilters","openModal","noAggregations","extractQueryFields","_isEmpty","drillToDetailMenuItem","drillToDetailByMenuItem","i","itemRef","itemIsTruncated","useCSSTextTruncation","truncationCSS","maxItemsContainerHeight","additionalItemsHeight","MAX_SAFE_INTEGER","vh","max","documentElement","clientHeight","innerHeight","menuHeight","min","submenuY","MenuDots","normal","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","MenuDotsWrapper","_ref12","_ref13","IconOrientation","_ref14","iconOrientation","VERTICAL","AntdDropdown","HORIZONTAL","MoreHoriz","RenderIcon","NoAnimationDropdown","overlayStyle","getEffectiveExtraFilters","op","cachedFiltersByChart","cachedFormdataByChart","getFormDataWithExtraFilters","nativeFilters","chartConfiguration","colorScheme","colorNamespace","sliceId","extraControls","allSliceIds","cachedFormData","areObjectsEqual","ignoreUndefined","color_namespace","label_colors","shared_label_colors","extraData","activeFilters","getAllActiveFilters","filterIdsAppliedOnChart","scope","filterId","extra_form_data","getExtraFormData","form_data","extra_filters","TableControlsWrapper","onInputChange","columnNames","columnTypes","originalTimeColumns","getTimeColumns","formattedTimeColumns","_zip","colname","formattedData","applyFormattingToTabularData","FilterInput","onChangeHandler","RowCount","CopyToClipboardButton","filterText","setFilterText","useTableColumns","filteredData","useFilteredTableData","TableView","pageSize","noDataText","emptyWrapperType","EmptyWrapperType","Small","isPaginationSticky","showRowCount","small","ResultTypes","pre","cache","WeakMap","useResultsPane","_metadata$queryObject","isRequest","queryForce","metadata","resultResp","setResultResp","queryCount","queryObjectCount","setForceQuery","getClientErrorObject","fill","err","idx","Wrapper","ResultsPaneOnDashboard","resultsPanes","panes","pane","Results","WeakSet","SamplesPane","setData","setColnames","setColtypes","SouthPane","DataTablesPane","onCollapseChange","activeTabKey","setActiveTabKey","setIsRequest","results","samples","panelOpen","setPanelOpen","DATAPANEL_CLOSED_BY_DEFAULT","getItem","LocalStorageKeys","is_datapanel_open","setItem","startsWith","Samples","handleCollapseChange","isOpen","handleTabClick","tabKey","CollapseButton","caretIcon","CaretUp","CaretDown","queryResultsPanes","tabBarExtraContent","activeKey","onTabClick","ViewQueryModalContainer","setResult","setError","statusText","JSON","stringify","query","ViewQuery","sql","language","datasetProps","setStatus","COMPLETE","items","_created_by$first_nam","_created_by$last_name","changed_on_humanized","created_on_humanized","table_name","changed_by","created_by","notAvailable","createdBy","first_name","last_name","trim","modifiedBy","formattedOwners","owner","MetadataType","TABLE","LAST_MODIFIED","OWNER","createdOn","DESCRIPTION","MetadataBar","tooltipPlacement","ReportType","NOTIFICATION_FORMATS","TEXT_BASED_VISUALIZATION_TYPES","INITIAL_STATE","crontab","EMPTY_OBJECT","withToasts","_chart$sliceFormData","userId","userEmail","creationMethod","dashboardName","sliceFormData","isChart","isTextBasedChart","defaultNotificationFormat","TEXT","PNG","entityName","initialState","reportReducer","action","currentReport","setCurrentReport","useReducer","cronError","setCronError","report","resourceType","CreationMethod","DASHBOARDS","CHARTS","reportSelector","isEditMode","wrappedTitle","StyledIconWrapper","Calendar","renderModalFooter","StyledFooterButton","newReportValues","active","force_screenshot","custom_width","creation_method","recipients","recipient_config_json","report_format","timezone","isSubmitting","editReport","addReport","renderMessageContentSection","StyledMessageContentTitle","StyledRadioGroup","StyledRadio","CSV","renderCustomWidthSection","StyledInputContainer","CustomWidthHeaderStyle","TRANSLATIONS","CUSTOM_SCREENSHOT_WIDTH_TEXT","CUSTOM_SCREENSHOT_WIDTH_PLACEHOLDER_TEXT","parseInt","StyledModal","centered","StyledTopSection","LabeledErrorBoundInput","required","validationMethods","noBottomMargin","StyledBottomSection","StyledScheduleTitle","SectionHeaderStyle","StyledCronPicker","clearButton","setValue","newValue","StyledCronError","TimezoneHeaderStyle","TimezoneSelector","onTimezoneChange","antDErrorAlertStyles","extensionsRegistry","getExtensionsRegistry","deleteColor","onMenuHover","onMenuItemHover","StyledDropdownItemWithIcon","DropdownItemExtension","isReportActive","canAddReports","ALERT_REPORTS","perms","permission","currentReportDeleting","setCurrentReportDeleting","prevDashboard","usePrevious","toggleActiveKey","checked","toggleActive","shouldFetch","fetchUISpecificReport","filterField","resourceId","handleShowMenu","ReportModal","email","Checkbox","handleDeleteMenuClick","Switch","marginLeft","zIndex","animationDuration","getPopupContainer","closest","DeleteModal","onConfirm","deleteActiveReport","handleReportDelete","channel","BroadcastChannel","useTabId","tabId","setTabId","localStorage","sessionStorage","isStorageAvailable","shortid","updateTabId","lastTabId","newTabId","storedTabId","postMessage","onmessage","messageEvent","cacheWrapper","SupersetClient","generateFileStem","date","kebabCase","toISOString","replace","selector","isExactSelector","elementToPrint","querySelector","domToImage","bgcolor","supersetTheme","light4","node","dataUrl","createElement","download","console","addWarningToast","CREATE_CHART_TEXT","UPDATE_CHART_TEXT","isCreating","filterClause","clause","_Object$entries$find","CLAUSES","WHERE","expressionType","sqlExpression","translateToSql","EXPRESSION_TYPES","SIMPLE","operator","comparator","operatorId","OPERATOR_ENUM_TO_OPERATOR_TYPE","operatorEntry","operation","isExtra","filterOptionName","random","substring"],"sourceRoot":""}